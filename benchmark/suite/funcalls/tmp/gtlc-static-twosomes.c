// gtlc-static.schml should return #(struct:Unit) generated by the schml
// compiler.

// This is the boiler plate
#include <stdio.h>
#include <stdlib.h>
#include <sys/time.h>

void *alloc_ptr;
long free_ptr;
long limit;
unsigned long allocd_mem;

long alloc(int n) {
  long result = free_ptr;
  long newFree = result + n;
  allocd_mem += n;
  if (newFree >= limit) {
    printf("Requesting more memory\n");
    free_ptr = (long)(posix_memalign(&alloc_ptr, 8, 409600000), alloc_ptr);
    limit = free_ptr + 409600000;
    return alloc(n);
  }
  free_ptr = newFree;
  return result;
}
// This is the global state for the timer
struct timeval timer_start_time;
struct timeval timer_stop_time;
struct timeval timer_result_time;
int timer_started = 1;
int timer_stopped = 1;

void timer_report() {

  // some very minor error checking
  if (timer_started) {
    printf("error starting timer");
    exit(-1);
  }
  if (timer_stopped) {
    printf("error stopping timer");
    exit(-1);
  }

  double t1 = timer_start_time.tv_sec + (timer_start_time.tv_usec / 1000000.0);
  double t2 = timer_stop_time.tv_sec + (timer_stop_time.tv_usec / 1000000.0);
  printf("time (sec): %lf\n", t2 - t1);
}

// These are the variable declarations

// These are the declarations
long u0_f(long u41_f_clos, long u1_n);
long u3_cast_fn_1(long u4_f, long u5_t1, long u6_t2, long u7_lbl);
long u37_annon(long u38_annon_clos, long u8_v);
long u17_rt_gvect_set(long u18_rt_gvect, long u19_rt_index,
                      long u20_rt_write_val);
long u14_rt_gvect_ref(long u15_rt_gvect, long u16_rt_index);
long u11_rt_gbox_set(long u12_rt_gref, long u13_rt_write_val);
long u9_rt_gunbox(long u10_rt_gref);
long u21_interp_cast(long u22_val, long u23_type1, long u24_type2,
                     long u25_label);

// Obviously this is the main function
int main() {
  long u159_unused_return;
  long u75_stop;
  long u74_start;
  long u73_tmp_value;
  long u72_tmp_value;
  long u71_result;
  long u42_f_clos;
  long u2_i;
  free_ptr = (long)(posix_memalign(&alloc_ptr, 8, 409600000), alloc_ptr);
  limit = free_ptr + 409600000;
  allocd_mem = 0;

  u42_f_clos = alloc(8 * 2);
  ((long *)u42_f_clos)[0] = ((long)u0_f);
  ((long *)u42_f_clos)[1] = ((long)u3_cast_fn_1);
  timer_started = gettimeofday(&timer_start_time, NULL);
  u74_start = 0;
  u75_stop = 1000000;
  for (u2_i = u74_start; u2_i < u75_stop; u2_i += 1) {
    u72_tmp_value = (-8 & u42_f_clos);
    u73_tmp_value = ((long *)u72_tmp_value)[0];
    u159_unused_return = (((long (*)(long, long))u73_tmp_value)(u42_f_clos, 0));
    __asm__("");
  };
  timer_stopped = gettimeofday(&timer_stop_time, NULL);
  timer_report();
  u71_result = 0;
  printf("Unit : ()\n");
  return 0;
}

// Here are all the definitions for Subroutines
long u0_f(long u41_f_clos, long u1_n) { return u1_n; }

long u3_cast_fn_1(long u4_f, long u5_t1, long u6_t2, long u7_lbl) {
  long u39_annon_clos;
  u39_annon_clos = alloc(8 * 6);
  ((long *)u39_annon_clos)[0] = ((long)u37_annon);
  ((long *)u39_annon_clos)[1] = ((long)u3_cast_fn_1);
  ((long *)u39_annon_clos)[2] = u6_t2;
  ((long *)u39_annon_clos)[3] = u7_lbl;
  ((long *)u39_annon_clos)[4] = u5_t1;
  ((long *)u39_annon_clos)[5] = u4_f;
  return u39_annon_clos;
}

long u37_annon(long u38_annon_clos, long u8_v) {
  long u96_tmp_value;
  long u95_tmp_value;
  long u94_tmp_value;
  long u93_tmp_value;
  long u92_tmp_value;
  long u91_tmp_value;
  long u90_tmp_value;
  long u89_tmp_value;
  long u88_tmp_value;
  long u87_tmp_value;
  long u86_tmp_value;
  long u85_tmp_value;
  long u84_tmp_value;
  long u83_tmp_value;
  long u82_tmp_value;
  long u81_tmp_value;
  long u80_tmp_value;
  long u79_tmp_value;
  long u78_tmp_value;
  long u77_tmp_value;
  long u76_tmp_value;
  long u40_tmp_closure;
  u76_tmp_value = (u38_annon_clos & -8);
  u40_tmp_closure = ((long *)u76_tmp_value)[5];
  u77_tmp_value = (-8 & u40_tmp_closure);
  u78_tmp_value = ((long *)u77_tmp_value)[0];
  u79_tmp_value = (u38_annon_clos & -8);
  u80_tmp_value = ((long *)u79_tmp_value)[2];
  u81_tmp_value = ((long *)u80_tmp_value)[2];
  u82_tmp_value = (u38_annon_clos & -8);
  u83_tmp_value = ((long *)u82_tmp_value)[4];
  u84_tmp_value = ((long *)u83_tmp_value)[2];
  u85_tmp_value = (u38_annon_clos & -8);
  u86_tmp_value = ((long *)u85_tmp_value)[3];
  u87_tmp_value =
      (u21_interp_cast(u8_v, u81_tmp_value, u84_tmp_value, u86_tmp_value));
  u88_tmp_value =
      (((long (*)(long, long))u78_tmp_value)(u40_tmp_closure, u87_tmp_value));
  u89_tmp_value = (u38_annon_clos & -8);
  u90_tmp_value = ((long *)u89_tmp_value)[4];
  u91_tmp_value = ((long *)u90_tmp_value)[1];
  u92_tmp_value = (u38_annon_clos & -8);
  u93_tmp_value = ((long *)u92_tmp_value)[2];
  u94_tmp_value = ((long *)u93_tmp_value)[1];
  u95_tmp_value = (u38_annon_clos & -8);
  u96_tmp_value = ((long *)u95_tmp_value)[3];
  return (u21_interp_cast(u88_tmp_value, u91_tmp_value, u94_tmp_value,
                          u96_tmp_value));
}

long u17_rt_gvect_set(long u18_rt_gvect, long u19_rt_index,
                      long u20_rt_write_val) {
  long u108_tmp_value;
  long u107_tmp_value;
  long u106_tmp_value;
  long u105_tmp_value;
  long u104_tmp_value;
  long u103_tmp_value;
  long u102_tmp_value;
  long u101_tmp_value;
  long u100_tmp_value;
  long u99_tmp_value;
  long u98_tmp_value;
  long u97_tmp_value;
  long u69_index;
  long u70_ugvect;
  u97_tmp_value = (u18_rt_gvect & 7);
  if (u97_tmp_value == 1) {
    u98_tmp_value = (u18_rt_gvect ^ 1);
    u99_tmp_value = ((long *)u98_tmp_value)[0];
    u100_tmp_value = (u18_rt_gvect ^ 1);
    u101_tmp_value = ((long *)u100_tmp_value)[2];
    u102_tmp_value = (u18_rt_gvect ^ 1);
    u103_tmp_value = ((long *)u102_tmp_value)[1];
    u104_tmp_value = (u18_rt_gvect ^ 1);
    u105_tmp_value = ((long *)u104_tmp_value)[3];
    u106_tmp_value = (u21_interp_cast(u20_rt_write_val, u101_tmp_value,
                                      u103_tmp_value, u105_tmp_value));
    return (u17_rt_gvect_set(u99_tmp_value, u19_rt_index, u106_tmp_value));
  } else {
    u69_index = u19_rt_index;
    if (u69_index >= 0) {
      u70_ugvect = u18_rt_gvect;
      u107_tmp_value = ((long *)u70_ugvect)[0];
      if (u69_index < u107_tmp_value) {
        u108_tmp_value = (u69_index + 1);
        ((long *)u70_ugvect)[u108_tmp_value] = u20_rt_write_val;
        return 0;
      } else {
        printf("index out of bound %l\n", (void *)u69_index);
        exit(-1);
        return 0;
      }
    } else {
      printf("index out of bound %l\n", (void *)u69_index);
      exit(-1);
      return 0;
    }
  }
}

long u14_rt_gvect_ref(long u15_rt_gvect, long u16_rt_index) {
  long u120_tmp_value;
  long u119_tmp_value;
  long u118_tmp_value;
  long u117_tmp_value;
  long u116_tmp_value;
  long u115_tmp_value;
  long u114_tmp_value;
  long u113_tmp_value;
  long u112_tmp_value;
  long u111_tmp_value;
  long u110_tmp_value;
  long u109_tmp_value;
  long u68_e;
  long u67_index;
  u109_tmp_value = (u15_rt_gvect & 7);
  if (u109_tmp_value == 1) {
    u110_tmp_value = (u15_rt_gvect ^ 1);
    u111_tmp_value = ((long *)u110_tmp_value)[0];
    u112_tmp_value = (u14_rt_gvect_ref(u111_tmp_value, u16_rt_index));
    u113_tmp_value = (u15_rt_gvect ^ 1);
    u114_tmp_value = ((long *)u113_tmp_value)[1];
    u115_tmp_value = (u15_rt_gvect ^ 1);
    u116_tmp_value = ((long *)u115_tmp_value)[2];
    u117_tmp_value = (u15_rt_gvect ^ 1);
    u118_tmp_value = ((long *)u117_tmp_value)[3];
    return (u21_interp_cast(u112_tmp_value, u114_tmp_value, u116_tmp_value,
                            u118_tmp_value));
  } else {
    u67_index = u16_rt_index;
    u68_e = u15_rt_gvect;
    if (u67_index >= 0) {
      u119_tmp_value = ((long *)u68_e)[0];
      if (u67_index < u119_tmp_value) {
        u120_tmp_value = (u67_index + 1);
        return ((long *)u68_e)[u120_tmp_value];
      } else {
        printf("index out of bound %l\n", (void *)u67_index);
        exit(-1);
        return 0;
      }
    } else {
      printf("index out of bound %l\n", (void *)u67_index);
      exit(-1);
      return 0;
    }
  }
}

long u11_rt_gbox_set(long u12_rt_gref, long u13_rt_write_val) {
  long u130_tmp_value;
  long u129_tmp_value;
  long u128_tmp_value;
  long u127_tmp_value;
  long u126_tmp_value;
  long u125_tmp_value;
  long u124_tmp_value;
  long u123_tmp_value;
  long u122_tmp_value;
  long u121_tmp_value;
  u121_tmp_value = (u12_rt_gref & 7);
  if (u121_tmp_value == 1) {
    u122_tmp_value = (u12_rt_gref ^ 1);
    u123_tmp_value = ((long *)u122_tmp_value)[0];
    u124_tmp_value = (u12_rt_gref ^ 1);
    u125_tmp_value = ((long *)u124_tmp_value)[2];
    u126_tmp_value = (u12_rt_gref ^ 1);
    u127_tmp_value = ((long *)u126_tmp_value)[1];
    u128_tmp_value = (u12_rt_gref ^ 1);
    u129_tmp_value = ((long *)u128_tmp_value)[3];
    u130_tmp_value = (u21_interp_cast(u13_rt_write_val, u125_tmp_value,
                                      u127_tmp_value, u129_tmp_value));
    return (u11_rt_gbox_set(u123_tmp_value, u130_tmp_value));
  } else {
    ((long *)u12_rt_gref)[0] = u13_rt_write_val;
    return 0;
  }
}

long u9_rt_gunbox(long u10_rt_gref) {
  long u140_tmp_value;
  long u139_tmp_value;
  long u138_tmp_value;
  long u137_tmp_value;
  long u136_tmp_value;
  long u135_tmp_value;
  long u134_tmp_value;
  long u133_tmp_value;
  long u132_tmp_value;
  long u131_tmp_value;
  u131_tmp_value = (u10_rt_gref & 7);
  if (u131_tmp_value == 1) {
    u132_tmp_value = (u10_rt_gref ^ 1);
    u133_tmp_value = ((long *)u132_tmp_value)[0];
    u134_tmp_value = (u9_rt_gunbox(u133_tmp_value));
    u135_tmp_value = (u10_rt_gref ^ 1);
    u136_tmp_value = ((long *)u135_tmp_value)[1];
    u137_tmp_value = (u10_rt_gref ^ 1);
    u138_tmp_value = ((long *)u137_tmp_value)[2];
    u139_tmp_value = (u10_rt_gref ^ 1);
    u140_tmp_value = ((long *)u139_tmp_value)[3];
    return (u21_interp_cast(u134_tmp_value, u136_tmp_value, u138_tmp_value,
                            u140_tmp_value));
  } else {
    return ((long *)u10_rt_gref)[0];
  }
}

long u21_interp_cast(long u22_val, long u23_type1, long u24_type2,
                     long u25_label) {
  long u158_tmp_value;
  long u157_tmp_value;
  long u156_tmp_value;
  long u155_tmp_value;
  long u154_tmp_value;
  long u153_tmp_value;
  long u152_tmp_value;
  long u151_tmp_value;
  long u150_tmp_value;
  long u149_tmp;
  long u148_tmp;
  long u147_tmp;
  long u146_tmp_value;
  long u145_tmp;
  long u144_tmp_value;
  long u143_tmp_value;
  long u142_tmp_value;
  long u141_tmp_value;
  long u26_tag;
  long u38_dyn_value_tmp;
  long u39_dyn_value_tag;
  long u40_tmp;
  long u41_tag;
  long u27_tag1;
  long u43_type;
  long u42_value;
  long u44_tag;
  long u45_imm;
  long u46_dynamic_boxed;
  long u28_tag2;
  long u29_type1_arity;
  long u30_type2_arity;
  long u48_type;
  long u47_value;
  long u49_tag;
  long u50_imm;
  long u51_dynamic_boxed;
  long u31_tag_gref;
  long u32_g1;
  long u33_g2;
  long u56_blame;
  long u55_target_t;
  long u54_source_t;
  long u53_guarded_ref;
  long u52_guarded_proxy;
  long u58_type;
  long u57_value;
  long u59_tag;
  long u60_imm;
  long u61_dynamic_boxed;
  long u34_tag_gvect;
  long u35_g1;
  long u36_g2;
  long u66_blame;
  long u65_target_t;
  long u64_source_t;
  long u63_guarded_ref;
  long u62_guarded_proxy;
  if (u23_type1 == u24_type2) {
    return u22_val;
  } else {
    if (u23_type1 == 7) {
      u26_tag = (u22_val & 7);
      if (1 == u26_tag) {
        u141_tmp_value = (u22_val >> 3);
        return (u21_interp_cast(u141_tmp_value, 15, u24_type2, u25_label));
      } else {
        if (7 == u26_tag) {
          u142_tmp_value = (u22_val >> 3);
          return (u21_interp_cast(u142_tmp_value, 23, u24_type2, u25_label));
        } else {
          if (2 == u26_tag) {
            return (u21_interp_cast(0, 31, u24_type2, u25_label));
          } else {
            if (0 == u26_tag) {
              u38_dyn_value_tmp = u22_val;
              u39_dyn_value_tag = (u38_dyn_value_tmp & 7);
              if (u39_dyn_value_tag == 0) {
                u143_tmp_value = ((long *)u38_dyn_value_tmp)[0];
                u145_tmp = u143_tmp_value;
              } else {
                u144_tmp_value = (u38_dyn_value_tmp >> 3);
                u145_tmp = u144_tmp_value;
              };
              u40_tmp = u22_val;
              u41_tag = (u40_tmp & 7);
              if (u41_tag == 0) {
                u146_tmp_value = ((long *)u40_tmp)[1];
                u149_tmp = u146_tmp_value;
              } else {
                if (u41_tag == 1) {
                  u148_tmp = 15;
                } else {
                  if (u41_tag == 7) {
                    u147_tmp = 23;
                  } else {
                    u147_tmp = 31;
                  };
                  u148_tmp = u147_tmp;
                };
                u149_tmp = u148_tmp;
              };
              return (
                  u21_interp_cast(u145_tmp, u149_tmp, u24_type2, u25_label));
            } else {
              puts(((const char *)"Unexpected value in cast tree"));
              exit(-1);
              return 0;
            }
          }
        }
      }
    } else {
      if (u23_type1 == 15) {
        if (7 == u24_type2) {
          u150_tmp_value = (u22_val << 3);
          return (u150_tmp_value + 1);
        } else {
          puts(((const char *)u25_label));
          exit(-1);
          return 0;
        }
      } else {
        if (u23_type1 == 23) {
          if (7 == u24_type2) {
            u151_tmp_value = (u22_val << 3);
            return (u151_tmp_value + 7);
          } else {
            puts(((const char *)u25_label));
            exit(-1);
            return 0;
          }
        } else {
          if (u23_type1 == 31) {
            if (7 == u24_type2) {
              u152_tmp_value = (u22_val << 3);
              return (u152_tmp_value + 2);
            } else {
              puts(((const char *)u25_label));
              exit(-1);
              return 0;
            }
          } else {
            u27_tag1 = (u23_type1 & 7);
            if (0 == u27_tag1) {
              if (7 == u24_type2) {
                u42_value = u22_val;
                u43_type = u23_type1;
                u44_tag = (u43_type & 7);
                if (u44_tag == 7) {
                  u45_imm = (u42_value << 3);
                  if (u43_type == 15) {
                    return (u45_imm | 1);
                  } else {
                    if (u43_type == 23) {
                      return (u45_imm | 7);
                    } else {
                      return (u45_imm | 2);
                    }
                  }
                } else {
                  u46_dynamic_boxed = alloc(8 * 2);
                  ((long *)u46_dynamic_boxed)[0] = u42_value;
                  ((long *)u46_dynamic_boxed)[1] = u43_type;
                  return u46_dynamic_boxed;
                }
              } else {
                u28_tag2 = (u24_type2 & 7);
                if (u28_tag2 == 0) {
                  u29_type1_arity = ((long *)u23_type1)[0];
                  u30_type2_arity = ((long *)u24_type2)[0];
                  if (u29_type1_arity == u30_type2_arity) {
                    u153_tmp_value = (-8 & u22_val);
                    u154_tmp_value = ((long *)u153_tmp_value)[1];
                    return (((long (*)(long, long, long, long))u154_tmp_value)(
                        u22_val, u23_type1, u24_type2, u25_label));
                  } else {
                    puts(((const char *)u25_label));
                    exit(-1);
                    return 0;
                  }
                } else {
                  puts(((const char *)u25_label));
                  exit(-1);
                  return 0;
                }
              }
            } else {
              if (1 == u27_tag1) {
                if (7 == u24_type2) {
                  u47_value = u22_val;
                  u48_type = u23_type1;
                  u49_tag = (u48_type & 7);
                  if (u49_tag == 7) {
                    u50_imm = (u47_value << 3);
                    if (u48_type == 15) {
                      return (u50_imm | 1);
                    } else {
                      if (u48_type == 23) {
                        return (u50_imm | 7);
                      } else {
                        return (u50_imm | 2);
                      }
                    }
                  } else {
                    u51_dynamic_boxed = alloc(8 * 2);
                    ((long *)u51_dynamic_boxed)[0] = u47_value;
                    ((long *)u51_dynamic_boxed)[1] = u48_type;
                    return u51_dynamic_boxed;
                  }
                } else {
                  u31_tag_gref = (u24_type2 & 7);
                  if (u31_tag_gref == 1) {
                    u155_tmp_value = (u23_type1 ^ 1);
                    u32_g1 = ((long *)u155_tmp_value)[0];
                    u156_tmp_value = (u24_type2 ^ 1);
                    u33_g2 = ((long *)u156_tmp_value)[0];
                    u53_guarded_ref = u22_val;
                    u54_source_t = u32_g1;
                    u55_target_t = u33_g2;
                    u56_blame = u25_label;
                    u52_guarded_proxy = alloc(8 * 4);
                    ((long *)u52_guarded_proxy)[0] = u53_guarded_ref;
                    ((long *)u52_guarded_proxy)[1] = u54_source_t;
                    ((long *)u52_guarded_proxy)[2] = u55_target_t;
                    ((long *)u52_guarded_proxy)[3] = u56_blame;
                    return (u52_guarded_proxy | 1);
                  } else {
                    puts(((const char *)u25_label));
                    exit(-1);
                    return 0;
                  }
                }
              } else {
                if (2 == u27_tag1) {
                  if (7 == u24_type2) {
                    u57_value = u22_val;
                    u58_type = u23_type1;
                    u59_tag = (u58_type & 7);
                    if (u59_tag == 7) {
                      u60_imm = (u57_value << 3);
                      if (u58_type == 15) {
                        return (u60_imm | 1);
                      } else {
                        if (u58_type == 23) {
                          return (u60_imm | 7);
                        } else {
                          return (u60_imm | 2);
                        }
                      }
                    } else {
                      u61_dynamic_boxed = alloc(8 * 2);
                      ((long *)u61_dynamic_boxed)[0] = u57_value;
                      ((long *)u61_dynamic_boxed)[1] = u58_type;
                      return u61_dynamic_boxed;
                    }
                  } else {
                    u34_tag_gvect = (u24_type2 & 7);
                    if (u34_tag_gvect == 2) {
                      u157_tmp_value = (u23_type1 ^ 2);
                      u35_g1 = ((long *)u157_tmp_value)[0];
                      u158_tmp_value = (u24_type2 ^ 2);
                      u36_g2 = ((long *)u158_tmp_value)[0];
                      u63_guarded_ref = u22_val;
                      u64_source_t = u35_g1;
                      u65_target_t = u36_g2;
                      u66_blame = u25_label;
                      u62_guarded_proxy = alloc(8 * 4);
                      ((long *)u62_guarded_proxy)[0] = u63_guarded_ref;
                      ((long *)u62_guarded_proxy)[1] = u64_source_t;
                      ((long *)u62_guarded_proxy)[2] = u65_target_t;
                      ((long *)u62_guarded_proxy)[3] = u66_blame;
                      return (u62_guarded_proxy | 1);
                    } else {
                      puts(((const char *)u25_label));
                      exit(-1);
                      return 0;
                    }
                  }
                } else {
                  puts(((const char *)"Unexpected Type1 in cast tree"));
                  exit(-1);
                  return 0;
                }
              }
            }
          }
        }
      }
    }
  }
}
