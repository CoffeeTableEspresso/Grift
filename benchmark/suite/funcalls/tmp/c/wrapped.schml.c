// wrapped.schml should return #(struct:Unit) generated by the schml compiler.

// This is the boiler plate
#include <stdio.h>
#include <stdlib.h>
#include <sys/time.h>

void *alloc_ptr;

// This is the global state for the timer
struct timeval timer_start_time;
struct timeval timer_stop_time;
struct timeval timer_result_time;
int timer_started = 1;
int timer_stopped = 1;

void timer_report() {

  // some very minor error checking
  if (timer_started) {
    printf("error starting timer");
    exit(-1);
  }
  if (timer_stopped) {
    printf("error stopping timer");
    exit(-1);
  }

  double t1 = timer_start_time.tv_sec + (timer_start_time.tv_usec / 1000000.0);
  double t2 = timer_stop_time.tv_sec + (timer_stop_time.tv_usec / 1000000.0);
  printf("time (sec): %lf\n", t2 - t1);
}

// These are the declarations
long u38_value(long u60_value_clos, long u1_n);
long u4_cast_fn1(long u51_cast_fn1_clos, long u5_f, long u6_t1, long u7_t2,
                 long u8_lbl);
long u43_annon(long u58_annon_clos);
long u42_annon(long u53_annon_clos, long u9_v);
long u10_interp_cast(long u44_interp_cast_clos, long u11_val, long u12_type1,
                     long u13_type2, long u14_label);

// Obviously this is the main function
int main() {
  long u123_unused_return;
  long u88_stop;
  long u87_start;
  long u86_tmp_value;
  long u85_tmp_value;
  long u84_tmp_value;
  long u83_tmp_value;
  long u45_interp_cast_clos;
  long u82_result;
  long u52_cast_fn1_clos;
  long u0_f;
  long u61_value_clos;
  long u62_tmp_clos;
  long u78_FunT;
  long u79_FunT;
  long u2_w;
  long u63_tmp_clos;
  long u80_FunT;
  long u81_FunT;
  long u3_i;
  u45_interp_cast_clos =
      (long)(posix_memalign(&alloc_ptr, 8, 8 * 3), alloc_ptr);
  ((long *)u45_interp_cast_clos)[0] = ((long)u10_interp_cast);
  ((long *)u45_interp_cast_clos)[1] = 0;
  ((long *)u45_interp_cast_clos)[2] = u45_interp_cast_clos;
  u52_cast_fn1_clos = (long)(posix_memalign(&alloc_ptr, 8, 8 * 4), alloc_ptr);
  ((long *)u52_cast_fn1_clos)[0] = ((long)u4_cast_fn1);
  ((long *)u52_cast_fn1_clos)[1] = 0;
  ((long *)u52_cast_fn1_clos)[2] = u52_cast_fn1_clos;
  ((long *)u52_cast_fn1_clos)[3] = u45_interp_cast_clos;
  u61_value_clos = (long)(posix_memalign(&alloc_ptr, 8, 8 * 2), alloc_ptr);
  ((long *)u61_value_clos)[0] = ((long)u38_value);
  ((long *)u61_value_clos)[1] = u52_cast_fn1_clos;
  u62_tmp_clos = ((long *)u61_value_clos)[1];
  u83_tmp_value = ((long *)u62_tmp_clos)[0];
  u78_FunT = (long)(posix_memalign(&alloc_ptr, 8, 8 * 3), alloc_ptr);
  ((long *)u78_FunT)[0] = 1;
  ((long *)u78_FunT)[1] = 7;
  ((long *)u78_FunT)[2] = 7;
  u79_FunT = (long)(posix_memalign(&alloc_ptr, 8, 8 * 3), alloc_ptr);
  ((long *)u79_FunT)[0] = 1;
  ((long *)u79_FunT)[1] = 15;
  ((long *)u79_FunT)[2] = 15;
  u0_f = (((long (*)(long, long, long, long, long))u83_tmp_value)(
      u62_tmp_clos, u61_value_clos, u78_FunT, u79_FunT,
      "Implicit cast in binding on expression at wrapped.schml::28"));
  u63_tmp_clos = ((long *)u0_f)[1];
  u84_tmp_value = ((long *)u63_tmp_clos)[0];
  u80_FunT = (long)(posix_memalign(&alloc_ptr, 8, 8 * 3), alloc_ptr);
  ((long *)u80_FunT)[0] = 1;
  ((long *)u80_FunT)[1] = 15;
  ((long *)u80_FunT)[2] = 15;
  u81_FunT = (long)(posix_memalign(&alloc_ptr, 8, 8 * 3), alloc_ptr);
  ((long *)u81_FunT)[0] = 1;
  ((long *)u81_FunT)[1] = 7;
  ((long *)u81_FunT)[2] = 7;
  u2_w = (((long (*)(long, long, long, long, long))u84_tmp_value)(
      u63_tmp_clos, u0_f, u80_FunT, u81_FunT,
      "Implicit cast in binding on expression at wrapped.schml::70"));
  timer_started = gettimeofday(&timer_start_time, NULL);
  u87_start = 0;
  u88_stop = 1000000;
  for (u3_i = u87_start; u3_i < u88_stop; u3_i += 1) {
    u85_tmp_value = ((long *)u2_w)[0];
    u86_tmp_value =
        (((long (*)(long, long, long, long, long))((long)u10_interp_cast))(
            u45_interp_cast_clos, 0, 15, 7, "Implicit cast in application at "
                                            "wrapped.schml::125 on expression "
                                            "at wrapped.schml::128"));
    u123_unused_return =
        (((long (*)(long, long))u85_tmp_value)(u2_w, u86_tmp_value));
    __asm__("");
  };
  timer_stopped = gettimeofday(&timer_stop_time, NULL);
  timer_report();
  u82_result = 0;
  printf("Unit : ()\n");
  return 0;
}

// Here are all the definitions for Subroutines
long u38_value(long u60_value_clos, long u1_n) { return u1_n; }

long u4_cast_fn1(long u51_cast_fn1_clos, long u5_f, long u6_t1, long u7_t2,
                 long u8_lbl) {
  long u93_tmp_value;
  long u92_tmp_value;
  long u91_tmp_value;
  long u90_tmp_value;
  long u89_tmp_value;
  long u54_annon_clos;
  long u59_annon_clos;
  u89_tmp_value = ((long *)u6_t1)[0];
  u90_tmp_value = ((long *)u7_t2)[0];
  if (u89_tmp_value == u90_tmp_value) {
    u54_annon_clos = (long)(posix_memalign(&alloc_ptr, 8, 8 * 7), alloc_ptr);
    ((long *)u54_annon_clos)[0] = ((long)u42_annon);
    u91_tmp_value = ((long *)u51_cast_fn1_clos)[2];
    ((long *)u54_annon_clos)[1] = u91_tmp_value;
    ((long *)u54_annon_clos)[2] = u8_lbl;
    ((long *)u54_annon_clos)[3] = u6_t1;
    ((long *)u54_annon_clos)[4] = u5_f;
    ((long *)u54_annon_clos)[5] = u7_t2;
    u92_tmp_value = ((long *)u51_cast_fn1_clos)[3];
    ((long *)u54_annon_clos)[6] = u92_tmp_value;
    return u54_annon_clos;
  } else {
    u59_annon_clos = (long)(posix_memalign(&alloc_ptr, 8, 8 * 3), alloc_ptr);
    ((long *)u59_annon_clos)[0] = ((long)u43_annon);
    u93_tmp_value = ((long *)u51_cast_fn1_clos)[2];
    ((long *)u59_annon_clos)[1] = u93_tmp_value;
    ((long *)u59_annon_clos)[2] = u8_lbl;
    return u59_annon_clos;
  }
}

long u43_annon(long u58_annon_clos) {
  long u94_tmp_value;
  u94_tmp_value = ((long *)u58_annon_clos)[2];
  puts(((const char *)u94_tmp_value));
  exit(-1);
  return 0;
}

long u42_annon(long u53_annon_clos, long u9_v) {
  long u109_tmp_value;
  long u108_tmp_value;
  long u107_tmp_value;
  long u106_tmp_value;
  long u105_tmp_value;
  long u104_tmp_value;
  long u103_tmp_value;
  long u102_tmp_value;
  long u101_tmp_value;
  long u100_tmp_value;
  long u99_tmp_value;
  long u98_tmp_value;
  long u97_tmp_value;
  long u96_tmp_value;
  long u95_tmp_value;
  long u57_tmp_clos;
  long u56_tmp_clos;
  long u55_tmp_clos;
  u57_tmp_clos = ((long *)u53_annon_clos)[6];
  u95_tmp_value = ((long *)u57_tmp_clos)[0];
  u56_tmp_clos = ((long *)u53_annon_clos)[4];
  u96_tmp_value = ((long *)u56_tmp_clos)[0];
  u55_tmp_clos = ((long *)u53_annon_clos)[6];
  u97_tmp_value = ((long *)u55_tmp_clos)[0];
  u98_tmp_value = ((long *)u53_annon_clos)[5];
  u99_tmp_value = ((long *)u98_tmp_value)[2];
  u100_tmp_value = ((long *)u53_annon_clos)[3];
  u101_tmp_value = ((long *)u100_tmp_value)[2];
  u102_tmp_value = ((long *)u53_annon_clos)[2];
  u103_tmp_value = (((long (*)(long, long, long, long, long))u97_tmp_value)(
      u55_tmp_clos, u9_v, u99_tmp_value, u101_tmp_value, u102_tmp_value));
  u104_tmp_value =
      (((long (*)(long, long))u96_tmp_value)(u56_tmp_clos, u103_tmp_value));
  u105_tmp_value = ((long *)u53_annon_clos)[3];
  u106_tmp_value = ((long *)u105_tmp_value)[1];
  u107_tmp_value = ((long *)u53_annon_clos)[5];
  u108_tmp_value = ((long *)u107_tmp_value)[1];
  u109_tmp_value = ((long *)u53_annon_clos)[2];
  return (((long (*)(long, long, long, long, long))u95_tmp_value)(
      u57_tmp_clos, u104_tmp_value, u106_tmp_value, u108_tmp_value,
      u109_tmp_value));
}

long u10_interp_cast(long u44_interp_cast_clos, long u11_val, long u12_type1,
                     long u13_type2, long u14_label) {
  long u122_tmp_value;
  long u121_tmp_value;
  long u120_tmp_value;
  long u119_tmp_value;
  long u118_tmp_value;
  long u117_tmp_value;
  long u116_tmp_value;
  long u115_tmp_value;
  long u114_tmp_value;
  long u113_tmp_value;
  long u112_tmp_value;
  long u111_tmp_value;
  long u110_tmp_value;
  long u18_tag;
  long u46_tmp_clos;
  long u47_tmp_clos;
  long u48_tmp_clos;
  long u49_tmp_clos;
  long u65_dyn_box_init;
  long u64_dyn_box_init;
  long u66_dyn_box;
  long u26_tag1;
  long u68_dyn_box_init;
  long u67_dyn_box_init;
  long u69_dyn_box;
  long u28_tag2;
  long u50_tmp_clos;
  long u71_dyn_box_init;
  long u70_dyn_box_init;
  long u72_dyn_box;
  long u33_tag_gref;
  long u34_g1;
  long u35_g2;
  long u77_blames;
  long u76_to;
  long u75_from;
  long u74_for;
  long u73_gproxy;
  if (u12_type1 == u13_type2) {
    return u11_val;
  } else {
    if (u12_type1 == 7) {
      u18_tag = (u11_val & 7);
      if (1 == u18_tag) {
        u46_tmp_clos = ((long *)u44_interp_cast_clos)[2];
        u110_tmp_value = ((long *)u46_tmp_clos)[0];
        u111_tmp_value = (u11_val >> 3);
        return (((long (*)(long, long, long, long, long))u110_tmp_value)(
            u46_tmp_clos, u111_tmp_value, 15, u13_type2, u14_label));
      } else {
        if (7 == u18_tag) {
          u47_tmp_clos = ((long *)u44_interp_cast_clos)[2];
          u112_tmp_value = ((long *)u47_tmp_clos)[0];
          u113_tmp_value = (u11_val >> 3);
          return (((long (*)(long, long, long, long, long))u112_tmp_value)(
              u47_tmp_clos, u113_tmp_value, 23, u13_type2, u14_label));
        } else {
          if (2 == u18_tag) {
            u48_tmp_clos = ((long *)u44_interp_cast_clos)[2];
            u114_tmp_value = ((long *)u48_tmp_clos)[0];
            return (((long (*)(long, long, long, long, long))u114_tmp_value)(
                u48_tmp_clos, 0, 23, u13_type2, u14_label));
          } else {
            if (0 == u18_tag) {
              u49_tmp_clos = ((long *)u44_interp_cast_clos)[2];
              u115_tmp_value = ((long *)u49_tmp_clos)[0];
              u116_tmp_value = ((long *)u11_val)[0];
              u117_tmp_value = ((long *)u11_val)[1];
              return (((long (*)(long, long, long, long, long))u115_tmp_value)(
                  u49_tmp_clos, u116_tmp_value, u117_tmp_value, u13_type2,
                  u14_label));
            } else {
              puts(((const char *)"Unexpected value in cast tree"));
              exit(-1);
              return 0;
            }
          }
        }
      }
    } else {
      if (u12_type1 == 15) {
        if (7 == u13_type2) {
          u118_tmp_value = (u11_val << 3);
          return (u118_tmp_value + 1);
        } else {
          puts(((const char *)u14_label));
          exit(-1);
          return 0;
        }
      } else {
        if (u12_type1 == 23) {
          if (7 == u13_type2) {
            u119_tmp_value = (u11_val << 3);
            return (u119_tmp_value + 7);
          } else {
            puts(((const char *)u14_label));
            exit(-1);
            return 0;
          }
        } else {
          if (u12_type1 == 31) {
            if (7 == u13_type2) {
              u64_dyn_box_init = u11_val;
              u65_dyn_box_init = 31;
              u66_dyn_box =
                  (long)(posix_memalign(&alloc_ptr, 8, 8 * 2), alloc_ptr);
              ((long *)u66_dyn_box)[0] = u64_dyn_box_init;
              ((long *)u66_dyn_box)[1] = u65_dyn_box_init;
              return u66_dyn_box;
            } else {
              puts(((const char *)u14_label));
              exit(-1);
              return 0;
            }
          } else {
            u26_tag1 = (u12_type1 & 7);
            if (0 == u26_tag1) {
              if (7 == u13_type2) {
                u67_dyn_box_init = u11_val;
                u68_dyn_box_init = u12_type1;
                u69_dyn_box =
                    (long)(posix_memalign(&alloc_ptr, 8, 8 * 2), alloc_ptr);
                ((long *)u69_dyn_box)[0] = u67_dyn_box_init;
                ((long *)u69_dyn_box)[1] = u68_dyn_box_init;
                return u69_dyn_box;
              } else {
                u28_tag2 = (u13_type2 & 7);
                if (u28_tag2 == 0) {
                  u50_tmp_clos = ((long *)u11_val)[1];
                  u120_tmp_value = ((long *)u50_tmp_clos)[0];
                  return ((
                      (long (*)(long, long, long, long, long))u120_tmp_value)(
                      u50_tmp_clos, u11_val, u12_type1, u13_type2, u14_label));
                } else {
                  puts(((const char *)u14_label));
                  exit(-1);
                  return 0;
                }
              }
            } else {
              if (1 == u26_tag1) {
                if (7 == u13_type2) {
                  u70_dyn_box_init = u11_val;
                  u71_dyn_box_init = u12_type1;
                  u72_dyn_box =
                      (long)(posix_memalign(&alloc_ptr, 8, 8 * 2), alloc_ptr);
                  ((long *)u72_dyn_box)[0] = u70_dyn_box_init;
                  ((long *)u72_dyn_box)[1] = u71_dyn_box_init;
                  return u72_dyn_box;
                } else {
                  u33_tag_gref = (u13_type2 & 7);
                  if (u33_tag_gref == 1) {
                    u121_tmp_value = (u12_type1 ^ 1);
                    u34_g1 = ((long *)u121_tmp_value)[0];
                    u122_tmp_value = (u13_type2 ^ 1);
                    u35_g2 = ((long *)u122_tmp_value)[0];
                    u74_for = u11_val;
                    u75_from = u34_g1;
                    u76_to = u35_g2;
                    u77_blames = u14_label;
                    u73_gproxy =
                        (long)(posix_memalign(&alloc_ptr, 8, 8 * 4), alloc_ptr);
                    ((long *)u73_gproxy)[0] = u74_for;
                    ((long *)u73_gproxy)[1] = u75_from;
                    ((long *)u73_gproxy)[2] = u76_to;
                    ((long *)u73_gproxy)[3] = u77_blames;
                    return (u73_gproxy | 1);
                  } else {
                    puts(((const char *)u14_label));
                    exit(-1);
                    return 0;
                  }
                }
              } else {
                puts(((const char *)"Unexpected Type1 in cast tree"));
                exit(-1);
                return 0;
              }
            }
          }
        }
      }
    }
  }
}
