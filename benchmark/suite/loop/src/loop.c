// loop.schml should return #(struct:Unit) generated by the schml compiler.

// This is the boiler plate
#include <stdio.h>
#include <stdlib.h>
#include <sys/time.h>

void *alloc_ptr;
long free_ptr;
long limit;
unsigned long allocd_mem;

long alloc(int n) {
  long result = free_ptr;
  long newFree = result + n;
  allocd_mem += n;
  if (newFree >= limit) {
    printf("Requesting more memory\n");
    free_ptr = (long)(posix_memalign(&alloc_ptr, 8, 9999999999), alloc_ptr);
    limit = free_ptr + 9999999999;
    return alloc(n);
  }
  free_ptr = newFree;
  return result;
}
// This is the global state for the timer
struct timeval timer_start_time;
struct timeval timer_stop_time;
struct timeval timer_result_time;
int timer_started = 1;
int timer_stopped = 1;

void timer_report() {

  // some very minor error checking
  if (timer_started) {
    printf("error starting timer");
    exit(-1);
  }
  if (timer_stopped) {
    printf("error stopping timer");
    exit(-1);
  }

  double t1 = timer_start_time.tv_sec + (timer_start_time.tv_usec / 1000000.0);
  double t2 = timer_stop_time.tv_sec + (timer_stop_time.tv_usec / 1000000.0);
  printf("time (sec): %lf\n", t2 - t1);
}

// These are the variable declarations

// These are the declarations
long u9_rt_gvect_set(long u10_rt_gvect, long u11_rt_index,
                     long u12_rt_write_val);
long u6_rt_gvect_ref(long u7_rt_gvect, long u8_rt_index);
long u3_rt_gbox_set(long u4_rt_gref, long u5_rt_write_val);
long u1_rt_gunbox(long u2_rt_gref);
long u13_interp_cast(long u14_val, long u15_type1, long u16_type2,
                     long u17_label);

// Obviously this is the main function
int main() {
  long u64_stop;
  long u63_start;
  long u62_result;
  long u0_i;
  free_ptr = (long)(posix_memalign(&alloc_ptr, 8, 9999999999), alloc_ptr);
  limit = free_ptr + 9999999999;
  allocd_mem = 0;

  timer_started = gettimeofday(&timer_start_time, NULL);
  u63_start = 0;
  u64_stop = 999999;
  for (u0_i = u63_start; u0_i < u64_stop; u0_i += 1) {
    0;
    __asm__("");
  };
  timer_stopped = gettimeofday(&timer_stop_time, NULL);
  timer_report();
  u62_result = 0;
  printf("Unit : ()\n");
  return 0;
}

// Here are all the definitions for Subroutines
long u9_rt_gvect_set(long u10_rt_gvect, long u11_rt_index,
                     long u12_rt_write_val) {
  long u76_tmp_value;
  long u75_tmp_value;
  long u74_tmp_value;
  long u73_tmp_value;
  long u72_tmp_value;
  long u71_tmp_value;
  long u70_tmp_value;
  long u69_tmp_value;
  long u68_tmp_value;
  long u67_tmp_value;
  long u66_tmp_value;
  long u65_tmp_value;
  long u60_index;
  long u61_ugvect;
  u65_tmp_value = (u10_rt_gvect & 7);
  if (u65_tmp_value == 1) {
    u66_tmp_value = (u10_rt_gvect ^ 1);
    u67_tmp_value = ((long *)u66_tmp_value)[0];
    u68_tmp_value = (u10_rt_gvect ^ 1);
    u69_tmp_value = ((long *)u68_tmp_value)[2];
    u70_tmp_value = (u10_rt_gvect ^ 1);
    u71_tmp_value = ((long *)u70_tmp_value)[1];
    u72_tmp_value = (u10_rt_gvect ^ 1);
    u73_tmp_value = ((long *)u72_tmp_value)[3];
    u74_tmp_value = (u13_interp_cast(u12_rt_write_val, u69_tmp_value,
                                     u71_tmp_value, u73_tmp_value));
    return (u9_rt_gvect_set(u67_tmp_value, u11_rt_index, u74_tmp_value));
  } else {
    u60_index = u11_rt_index;
    if (u60_index >= 0) {
      u61_ugvect = u10_rt_gvect;
      u75_tmp_value = ((long *)u61_ugvect)[0];
      if (u60_index < u75_tmp_value) {
        u76_tmp_value = (u60_index + 1);
        ((long *)u61_ugvect)[u76_tmp_value] = u12_rt_write_val;
        return 0;
      } else {
        printf("index out of bound %l\n", (void *)u60_index);
        exit(-1);
        return 0;
      }
    } else {
      printf("index out of bound %l\n", (void *)u60_index);
      exit(-1);
      return 0;
    }
  }
}

long u6_rt_gvect_ref(long u7_rt_gvect, long u8_rt_index) {
  long u88_tmp_value;
  long u87_tmp_value;
  long u86_tmp_value;
  long u85_tmp_value;
  long u84_tmp_value;
  long u83_tmp_value;
  long u82_tmp_value;
  long u81_tmp_value;
  long u80_tmp_value;
  long u79_tmp_value;
  long u78_tmp_value;
  long u77_tmp_value;
  long u59_e;
  long u58_index;
  u77_tmp_value = (u7_rt_gvect & 7);
  if (u77_tmp_value == 1) {
    u78_tmp_value = (u7_rt_gvect ^ 1);
    u79_tmp_value = ((long *)u78_tmp_value)[0];
    u80_tmp_value = (u6_rt_gvect_ref(u79_tmp_value, u8_rt_index));
    u81_tmp_value = (u7_rt_gvect ^ 1);
    u82_tmp_value = ((long *)u81_tmp_value)[1];
    u83_tmp_value = (u7_rt_gvect ^ 1);
    u84_tmp_value = ((long *)u83_tmp_value)[2];
    u85_tmp_value = (u7_rt_gvect ^ 1);
    u86_tmp_value = ((long *)u85_tmp_value)[3];
    return (u13_interp_cast(u80_tmp_value, u82_tmp_value, u84_tmp_value,
                            u86_tmp_value));
  } else {
    u58_index = u8_rt_index;
    u59_e = u7_rt_gvect;
    if (u58_index >= 0) {
      u87_tmp_value = ((long *)u59_e)[0];
      if (u58_index < u87_tmp_value) {
        u88_tmp_value = (u58_index + 1);
        return ((long *)u59_e)[u88_tmp_value];
      } else {
        printf("index out of bound %l\n", (void *)u58_index);
        exit(-1);
        return 0;
      }
    } else {
      printf("index out of bound %l\n", (void *)u58_index);
      exit(-1);
      return 0;
    }
  }
}

long u3_rt_gbox_set(long u4_rt_gref, long u5_rt_write_val) {
  long u98_tmp_value;
  long u97_tmp_value;
  long u96_tmp_value;
  long u95_tmp_value;
  long u94_tmp_value;
  long u93_tmp_value;
  long u92_tmp_value;
  long u91_tmp_value;
  long u90_tmp_value;
  long u89_tmp_value;
  u89_tmp_value = (u4_rt_gref & 7);
  if (u89_tmp_value == 1) {
    u90_tmp_value = (u4_rt_gref ^ 1);
    u91_tmp_value = ((long *)u90_tmp_value)[0];
    u92_tmp_value = (u4_rt_gref ^ 1);
    u93_tmp_value = ((long *)u92_tmp_value)[2];
    u94_tmp_value = (u4_rt_gref ^ 1);
    u95_tmp_value = ((long *)u94_tmp_value)[1];
    u96_tmp_value = (u4_rt_gref ^ 1);
    u97_tmp_value = ((long *)u96_tmp_value)[3];
    u98_tmp_value = (u13_interp_cast(u5_rt_write_val, u93_tmp_value,
                                     u95_tmp_value, u97_tmp_value));
    return (u3_rt_gbox_set(u91_tmp_value, u98_tmp_value));
  } else {
    ((long *)u4_rt_gref)[0] = u5_rt_write_val;
    return 0;
  }
}

long u1_rt_gunbox(long u2_rt_gref) {
  long u108_tmp_value;
  long u107_tmp_value;
  long u106_tmp_value;
  long u105_tmp_value;
  long u104_tmp_value;
  long u103_tmp_value;
  long u102_tmp_value;
  long u101_tmp_value;
  long u100_tmp_value;
  long u99_tmp_value;
  u99_tmp_value = (u2_rt_gref & 7);
  if (u99_tmp_value == 1) {
    u100_tmp_value = (u2_rt_gref ^ 1);
    u101_tmp_value = ((long *)u100_tmp_value)[0];
    u102_tmp_value = (u1_rt_gunbox(u101_tmp_value));
    u103_tmp_value = (u2_rt_gref ^ 1);
    u104_tmp_value = ((long *)u103_tmp_value)[1];
    u105_tmp_value = (u2_rt_gref ^ 1);
    u106_tmp_value = ((long *)u105_tmp_value)[2];
    u107_tmp_value = (u2_rt_gref ^ 1);
    u108_tmp_value = ((long *)u107_tmp_value)[3];
    return (u13_interp_cast(u102_tmp_value, u104_tmp_value, u106_tmp_value,
                            u108_tmp_value));
  } else {
    return ((long *)u2_rt_gref)[0];
  }
}

long u13_interp_cast(long u14_val, long u15_type1, long u16_type2,
                     long u17_label) {
  long u126_tmp_value;
  long u125_tmp_value;
  long u124_tmp_value;
  long u123_tmp_value;
  long u122_tmp_value;
  long u121_tmp_value;
  long u120_tmp_value;
  long u119_tmp_value;
  long u118_tmp_value;
  long u117_tmp;
  long u116_tmp;
  long u115_tmp;
  long u114_tmp_value;
  long u113_tmp;
  long u112_tmp_value;
  long u111_tmp_value;
  long u110_tmp_value;
  long u109_tmp_value;
  long u18_tag;
  long u29_dyn_value_tmp;
  long u30_dyn_value_tag;
  long u31_tmp;
  long u32_tag;
  long u19_tag1;
  long u34_type;
  long u33_value;
  long u35_tag;
  long u36_imm;
  long u37_dynamic_boxed;
  long u20_tag2;
  long u21_type1_arity;
  long u22_type2_arity;
  long u39_type;
  long u38_value;
  long u40_tag;
  long u41_imm;
  long u42_dynamic_boxed;
  long u23_tag_gref;
  long u24_g1;
  long u25_g2;
  long u47_blame;
  long u46_target_t;
  long u45_source_t;
  long u44_guarded_ref;
  long u43_guarded_proxy;
  long u49_type;
  long u48_value;
  long u50_tag;
  long u51_imm;
  long u52_dynamic_boxed;
  long u26_tag_gvect;
  long u27_g1;
  long u28_g2;
  long u57_blame;
  long u56_target_t;
  long u55_source_t;
  long u54_guarded_ref;
  long u53_guarded_proxy;
  if (u15_type1 == u16_type2) {
    return u14_val;
  } else {
    if (u15_type1 == 7) {
      u18_tag = (u14_val & 7);
      if (1 == u18_tag) {
        u109_tmp_value = (u14_val >> 3);
        return (u13_interp_cast(u109_tmp_value, 15, u16_type2, u17_label));
      } else {
        if (7 == u18_tag) {
          u110_tmp_value = (u14_val >> 3);
          return (u13_interp_cast(u110_tmp_value, 23, u16_type2, u17_label));
        } else {
          if (2 == u18_tag) {
            return (u13_interp_cast(0, 31, u16_type2, u17_label));
          } else {
            if (0 == u18_tag) {
              u29_dyn_value_tmp = u14_val;
              u30_dyn_value_tag = (u29_dyn_value_tmp & 7);
              if (u30_dyn_value_tag == 0) {
                u111_tmp_value = ((long *)u29_dyn_value_tmp)[0];
                u113_tmp = u111_tmp_value;
              } else {
                u112_tmp_value = (u29_dyn_value_tmp >> 3);
                u113_tmp = u112_tmp_value;
              };
              u31_tmp = u14_val;
              u32_tag = (u31_tmp & 7);
              if (u32_tag == 0) {
                u114_tmp_value = ((long *)u31_tmp)[1];
                u117_tmp = u114_tmp_value;
              } else {
                if (u32_tag == 1) {
                  u116_tmp = 15;
                } else {
                  if (u32_tag == 7) {
                    u115_tmp = 23;
                  } else {
                    u115_tmp = 31;
                  };
                  u116_tmp = u115_tmp;
                };
                u117_tmp = u116_tmp;
              };
              return (
                  u13_interp_cast(u113_tmp, u117_tmp, u16_type2, u17_label));
            } else {
              puts(((const char *)"Unexpected value in cast tree"));
              exit(-1);
              return 0;
            }
          }
        }
      }
    } else {
      if (u15_type1 == 15) {
        if (7 == u16_type2) {
          u118_tmp_value = (u14_val << 3);
          return (u118_tmp_value + 1);
        } else {
          puts(((const char *)u17_label));
          exit(-1);
          return 0;
        }
      } else {
        if (u15_type1 == 23) {
          if (7 == u16_type2) {
            u119_tmp_value = (u14_val << 3);
            return (u119_tmp_value + 7);
          } else {
            puts(((const char *)u17_label));
            exit(-1);
            return 0;
          }
        } else {
          if (u15_type1 == 31) {
            if (7 == u16_type2) {
              u120_tmp_value = (u14_val << 3);
              return (u120_tmp_value + 2);
            } else {
              puts(((const char *)u17_label));
              exit(-1);
              return 0;
            }
          } else {
            u19_tag1 = (u15_type1 & 7);
            if (0 == u19_tag1) {
              if (7 == u16_type2) {
                u33_value = u14_val;
                u34_type = u15_type1;
                u35_tag = (u34_type & 7);
                if (u35_tag == 7) {
                  u36_imm = (u33_value << 3);
                  if (u34_type == 15) {
                    return (u36_imm | 1);
                  } else {
                    if (u34_type == 23) {
                      return (u36_imm | 7);
                    } else {
                      return (u36_imm | 2);
                    }
                  }
                } else {
                  u37_dynamic_boxed = alloc(8 * 2);
                  ((long *)u37_dynamic_boxed)[0] = u33_value;
                  ((long *)u37_dynamic_boxed)[1] = u34_type;
                  return u37_dynamic_boxed;
                }
              } else {
                u20_tag2 = (u16_type2 & 7);
                if (u20_tag2 == 0) {
                  u21_type1_arity = ((long *)u15_type1)[0];
                  u22_type2_arity = ((long *)u16_type2)[0];
                  if (u21_type1_arity == u22_type2_arity) {
                    u121_tmp_value = (-8 & u14_val);
                    u122_tmp_value = ((long *)u121_tmp_value)[1];
                    return (((long (*)(long, long, long, long))u122_tmp_value)(
                        u14_val, u15_type1, u16_type2, u17_label));
                  } else {
                    puts(((const char *)u17_label));
                    exit(-1);
                    return 0;
                  }
                } else {
                  puts(((const char *)u17_label));
                  exit(-1);
                  return 0;
                }
              }
            } else {
              if (1 == u19_tag1) {
                if (7 == u16_type2) {
                  u38_value = u14_val;
                  u39_type = u15_type1;
                  u40_tag = (u39_type & 7);
                  if (u40_tag == 7) {
                    u41_imm = (u38_value << 3);
                    if (u39_type == 15) {
                      return (u41_imm | 1);
                    } else {
                      if (u39_type == 23) {
                        return (u41_imm | 7);
                      } else {
                        return (u41_imm | 2);
                      }
                    }
                  } else {
                    u42_dynamic_boxed = alloc(8 * 2);
                    ((long *)u42_dynamic_boxed)[0] = u38_value;
                    ((long *)u42_dynamic_boxed)[1] = u39_type;
                    return u42_dynamic_boxed;
                  }
                } else {
                  u23_tag_gref = (u16_type2 & 7);
                  if (u23_tag_gref == 1) {
                    u123_tmp_value = (u15_type1 ^ 1);
                    u24_g1 = ((long *)u123_tmp_value)[0];
                    u124_tmp_value = (u16_type2 ^ 1);
                    u25_g2 = ((long *)u124_tmp_value)[0];
                    u44_guarded_ref = u14_val;
                    u45_source_t = u24_g1;
                    u46_target_t = u25_g2;
                    u47_blame = u17_label;
                    u43_guarded_proxy = alloc(8 * 4);
                    ((long *)u43_guarded_proxy)[0] = u44_guarded_ref;
                    ((long *)u43_guarded_proxy)[1] = u45_source_t;
                    ((long *)u43_guarded_proxy)[2] = u46_target_t;
                    ((long *)u43_guarded_proxy)[3] = u47_blame;
                    return (u43_guarded_proxy | 1);
                  } else {
                    puts(((const char *)u17_label));
                    exit(-1);
                    return 0;
                  }
                }
              } else {
                if (2 == u19_tag1) {
                  if (7 == u16_type2) {
                    u48_value = u14_val;
                    u49_type = u15_type1;
                    u50_tag = (u49_type & 7);
                    if (u50_tag == 7) {
                      u51_imm = (u48_value << 3);
                      if (u49_type == 15) {
                        return (u51_imm | 1);
                      } else {
                        if (u49_type == 23) {
                          return (u51_imm | 7);
                        } else {
                          return (u51_imm | 2);
                        }
                      }
                    } else {
                      u52_dynamic_boxed = alloc(8 * 2);
                      ((long *)u52_dynamic_boxed)[0] = u48_value;
                      ((long *)u52_dynamic_boxed)[1] = u49_type;
                      return u52_dynamic_boxed;
                    }
                  } else {
                    u26_tag_gvect = (u16_type2 & 7);
                    if (u26_tag_gvect == 2) {
                      u125_tmp_value = (u15_type1 ^ 2);
                      u27_g1 = ((long *)u125_tmp_value)[0];
                      u126_tmp_value = (u16_type2 ^ 2);
                      u28_g2 = ((long *)u126_tmp_value)[0];
                      u54_guarded_ref = u14_val;
                      u55_source_t = u27_g1;
                      u56_target_t = u28_g2;
                      u57_blame = u17_label;
                      u53_guarded_proxy = alloc(8 * 4);
                      ((long *)u53_guarded_proxy)[0] = u54_guarded_ref;
                      ((long *)u53_guarded_proxy)[1] = u55_source_t;
                      ((long *)u53_guarded_proxy)[2] = u56_target_t;
                      ((long *)u53_guarded_proxy)[3] = u57_blame;
                      return (u53_guarded_proxy | 1);
                    } else {
                      puts(((const char *)u17_label));
                      exit(-1);
                      return 0;
                    }
                  }
                } else {
                  puts(((const char *)"Unexpected Type1 in cast tree"));
                  exit(-1);
                  return 0;
                }
              }
            }
          }
        }
      }
    }
  }
}
