// dynamic.schml should return #(struct:Unit) generated by the schml compiler.

// This is the boiler plate
#include <stdio.h>
#include <stdlib.h>
#include <sys/time.h>

void *alloc_ptr;

// This is the global state for the timer
struct timeval timer_start_time;
struct timeval timer_stop_time;
struct timeval timer_result_time;
int timer_started = 1;
int timer_stopped = 1;

void timer_report() {

  // some very minor error checking
  if (timer_started) {
    printf("error starting timer");
    exit(-1);
  }
  if (timer_stopped) {
    printf("error stopping timer");
    exit(-1);
  }

  double t1 = timer_start_time.tv_sec + (timer_start_time.tv_usec / 1000000.0);
  double t2 = timer_stop_time.tv_sec + (timer_stop_time.tv_usec / 1000000.0);
  printf("time (sec): %lf\n", t2 - t1);
}

// These are the declarations
long u38_value(long u57_value_clos, long u1_n);
long u4_cast_fn1(long u48_cast_fn1_clos, long u5_f, long u6_t1, long u7_t2,
                 long u8_lbl);
long u40_annon(long u55_annon_clos);
long u39_annon(long u50_annon_clos, long u9_v);
long u10_interp_cast(long u41_interp_cast_clos, long u11_val, long u12_type1,
                     long u13_type2, long u14_label);

// Obviously this is the main function
int main() {
  long u118_unused_return;
  long u83_stop;
  long u82_start;
  long u81_tmp_value;
  long u80_tmp_value;
  long u42_interp_cast_clos;
  long u79_result;
  long u49_cast_fn1_clos;
  long u0_f;
  long u58_value_clos;
  long u59_tmp_clos;
  long u75_FunT;
  long u76_FunT;
  long u2_d;
  long u77_FunT;
  long u3_i;
  long u60_tmp_clos;
  long u78_FunT;
  u42_interp_cast_clos =
      (long)(posix_memalign(&alloc_ptr, 8, 8 * 3), alloc_ptr);
  ((long *)u42_interp_cast_clos)[0] = ((long)u10_interp_cast);
  ((long *)u42_interp_cast_clos)[1] = 0;
  ((long *)u42_interp_cast_clos)[2] = u42_interp_cast_clos;
  u49_cast_fn1_clos = (long)(posix_memalign(&alloc_ptr, 8, 8 * 4), alloc_ptr);
  ((long *)u49_cast_fn1_clos)[0] = ((long)u4_cast_fn1);
  ((long *)u49_cast_fn1_clos)[1] = 0;
  ((long *)u49_cast_fn1_clos)[2] = u49_cast_fn1_clos;
  ((long *)u49_cast_fn1_clos)[3] = u42_interp_cast_clos;
  u58_value_clos = (long)(posix_memalign(&alloc_ptr, 8, 8 * 2), alloc_ptr);
  ((long *)u58_value_clos)[0] = ((long)u38_value);
  ((long *)u58_value_clos)[1] = u49_cast_fn1_clos;
  u59_tmp_clos = ((long *)u58_value_clos)[1];
  u80_tmp_value = ((long *)u59_tmp_clos)[0];
  u75_FunT = (long)(posix_memalign(&alloc_ptr, 8, 8 * 3), alloc_ptr);
  ((long *)u75_FunT)[0] = 1;
  ((long *)u75_FunT)[1] = 7;
  ((long *)u75_FunT)[2] = 7;
  u76_FunT = (long)(posix_memalign(&alloc_ptr, 8, 8 * 3), alloc_ptr);
  ((long *)u76_FunT)[0] = 1;
  ((long *)u76_FunT)[1] = 15;
  ((long *)u76_FunT)[2] = 15;
  u0_f = (((long (*)(long, long, long, long, long))u80_tmp_value)(
      u59_tmp_clos, u58_value_clos, u75_FunT, u76_FunT,
      "Implicit cast in binding on expression at dynamic.schml::28"));
  u77_FunT = (long)(posix_memalign(&alloc_ptr, 8, 8 * 3), alloc_ptr);
  ((long *)u77_FunT)[0] = 1;
  ((long *)u77_FunT)[1] = 15;
  ((long *)u77_FunT)[2] = 15;
  u2_d = (((long (*)(long, long, long, long, long))((long)u10_interp_cast))(
      u42_interp_cast_clos, u0_f, u77_FunT, 7,
      "Implicit cast in binding on expression at dynamic.schml::61"));
  timer_started = gettimeofday(&timer_start_time, NULL);
  u82_start = 0;
  u83_stop = 1000000;
  for (u3_i = u82_start; u3_i < u83_stop; u3_i += 1) {
    u78_FunT = (long)(posix_memalign(&alloc_ptr, 8, 8 * 3), alloc_ptr);
    ((long *)u78_FunT)[0] = 1;
    ((long *)u78_FunT)[1] = 7;
    ((long *)u78_FunT)[2] = 15;
    u60_tmp_clos =
        (((long (*)(long, long, long, long, long))((long)u10_interp_cast))(
            u42_interp_cast_clos, u2_d, 7, u78_FunT,
            "Implicit cast in Application at dynamic.schml::116 on expression "
            "at dynamic.schml::117"));
    u81_tmp_value = ((long *)u60_tmp_clos)[0];
    u118_unused_return =
        (((long (*)(long, long))u81_tmp_value)(u60_tmp_clos, 0));
    __asm__("");
  };
  timer_stopped = gettimeofday(&timer_stop_time, NULL);
  timer_report();
  u79_result = 0;
  printf("Unit : ()\n");
  return 0;
}

// Here are all the definitions for Subroutines
long u38_value(long u57_value_clos, long u1_n) { return u1_n; }

long u4_cast_fn1(long u48_cast_fn1_clos, long u5_f, long u6_t1, long u7_t2,
                 long u8_lbl) {
  long u88_tmp_value;
  long u87_tmp_value;
  long u86_tmp_value;
  long u85_tmp_value;
  long u84_tmp_value;
  long u51_annon_clos;
  long u56_annon_clos;
  u84_tmp_value = ((long *)u6_t1)[0];
  u85_tmp_value = ((long *)u7_t2)[0];
  if (u84_tmp_value == u85_tmp_value) {
    u51_annon_clos = (long)(posix_memalign(&alloc_ptr, 8, 8 * 7), alloc_ptr);
    ((long *)u51_annon_clos)[0] = ((long)u39_annon);
    u86_tmp_value = ((long *)u48_cast_fn1_clos)[2];
    ((long *)u51_annon_clos)[1] = u86_tmp_value;
    ((long *)u51_annon_clos)[2] = u8_lbl;
    ((long *)u51_annon_clos)[3] = u6_t1;
    ((long *)u51_annon_clos)[4] = u5_f;
    ((long *)u51_annon_clos)[5] = u7_t2;
    u87_tmp_value = ((long *)u48_cast_fn1_clos)[3];
    ((long *)u51_annon_clos)[6] = u87_tmp_value;
    return u51_annon_clos;
  } else {
    u56_annon_clos = (long)(posix_memalign(&alloc_ptr, 8, 8 * 3), alloc_ptr);
    ((long *)u56_annon_clos)[0] = ((long)u40_annon);
    u88_tmp_value = ((long *)u48_cast_fn1_clos)[2];
    ((long *)u56_annon_clos)[1] = u88_tmp_value;
    ((long *)u56_annon_clos)[2] = u8_lbl;
    return u56_annon_clos;
  }
}

long u40_annon(long u55_annon_clos) {
  long u89_tmp_value;
  u89_tmp_value = ((long *)u55_annon_clos)[2];
  puts(((const char *)u89_tmp_value));
  exit(-1);
  return 0;
}

long u39_annon(long u50_annon_clos, long u9_v) {
  long u104_tmp_value;
  long u103_tmp_value;
  long u102_tmp_value;
  long u101_tmp_value;
  long u100_tmp_value;
  long u99_tmp_value;
  long u98_tmp_value;
  long u97_tmp_value;
  long u96_tmp_value;
  long u95_tmp_value;
  long u94_tmp_value;
  long u93_tmp_value;
  long u92_tmp_value;
  long u91_tmp_value;
  long u90_tmp_value;
  long u54_tmp_clos;
  long u53_tmp_clos;
  long u52_tmp_clos;
  u54_tmp_clos = ((long *)u50_annon_clos)[6];
  u90_tmp_value = ((long *)u54_tmp_clos)[0];
  u53_tmp_clos = ((long *)u50_annon_clos)[4];
  u91_tmp_value = ((long *)u53_tmp_clos)[0];
  u52_tmp_clos = ((long *)u50_annon_clos)[6];
  u92_tmp_value = ((long *)u52_tmp_clos)[0];
  u93_tmp_value = ((long *)u50_annon_clos)[5];
  u94_tmp_value = ((long *)u93_tmp_value)[2];
  u95_tmp_value = ((long *)u50_annon_clos)[3];
  u96_tmp_value = ((long *)u95_tmp_value)[2];
  u97_tmp_value = ((long *)u50_annon_clos)[2];
  u98_tmp_value = (((long (*)(long, long, long, long, long))u92_tmp_value)(
      u52_tmp_clos, u9_v, u94_tmp_value, u96_tmp_value, u97_tmp_value));
  u99_tmp_value =
      (((long (*)(long, long))u91_tmp_value)(u53_tmp_clos, u98_tmp_value));
  u100_tmp_value = ((long *)u50_annon_clos)[3];
  u101_tmp_value = ((long *)u100_tmp_value)[1];
  u102_tmp_value = ((long *)u50_annon_clos)[5];
  u103_tmp_value = ((long *)u102_tmp_value)[1];
  u104_tmp_value = ((long *)u50_annon_clos)[2];
  return (((long (*)(long, long, long, long, long))u90_tmp_value)(
      u54_tmp_clos, u99_tmp_value, u101_tmp_value, u103_tmp_value,
      u104_tmp_value));
}

long u10_interp_cast(long u41_interp_cast_clos, long u11_val, long u12_type1,
                     long u13_type2, long u14_label) {
  long u117_tmp_value;
  long u116_tmp_value;
  long u115_tmp_value;
  long u114_tmp_value;
  long u113_tmp_value;
  long u112_tmp_value;
  long u111_tmp_value;
  long u110_tmp_value;
  long u109_tmp_value;
  long u108_tmp_value;
  long u107_tmp_value;
  long u106_tmp_value;
  long u105_tmp_value;
  long u18_tag;
  long u43_tmp_clos;
  long u44_tmp_clos;
  long u45_tmp_clos;
  long u46_tmp_clos;
  long u62_dyn_box_init;
  long u61_dyn_box_init;
  long u63_dyn_box;
  long u26_tag1;
  long u65_dyn_box_init;
  long u64_dyn_box_init;
  long u66_dyn_box;
  long u28_tag2;
  long u47_tmp_clos;
  long u68_dyn_box_init;
  long u67_dyn_box_init;
  long u69_dyn_box;
  long u33_tag_gref;
  long u34_g1;
  long u35_g2;
  long u74_blames;
  long u73_to;
  long u72_from;
  long u71_for;
  long u70_gproxy;
  if (u12_type1 == u13_type2) {
    return u11_val;
  } else {
    if (u12_type1 == 7) {
      u18_tag = (u11_val & 7);
      if (1 == u18_tag) {
        u43_tmp_clos = ((long *)u41_interp_cast_clos)[2];
        u105_tmp_value = ((long *)u43_tmp_clos)[0];
        u106_tmp_value = (u11_val >> 3);
        return (((long (*)(long, long, long, long, long))u105_tmp_value)(
            u43_tmp_clos, u106_tmp_value, 15, u13_type2, u14_label));
      } else {
        if (7 == u18_tag) {
          u44_tmp_clos = ((long *)u41_interp_cast_clos)[2];
          u107_tmp_value = ((long *)u44_tmp_clos)[0];
          u108_tmp_value = (u11_val >> 3);
          return (((long (*)(long, long, long, long, long))u107_tmp_value)(
              u44_tmp_clos, u108_tmp_value, 23, u13_type2, u14_label));
        } else {
          if (2 == u18_tag) {
            u45_tmp_clos = ((long *)u41_interp_cast_clos)[2];
            u109_tmp_value = ((long *)u45_tmp_clos)[0];
            return (((long (*)(long, long, long, long, long))u109_tmp_value)(
                u45_tmp_clos, 0, 23, u13_type2, u14_label));
          } else {
            if (0 == u18_tag) {
              u46_tmp_clos = ((long *)u41_interp_cast_clos)[2];
              u110_tmp_value = ((long *)u46_tmp_clos)[0];
              u111_tmp_value = ((long *)u11_val)[0];
              u112_tmp_value = ((long *)u11_val)[1];
              return (((long (*)(long, long, long, long, long))u110_tmp_value)(
                  u46_tmp_clos, u111_tmp_value, u112_tmp_value, u13_type2,
                  u14_label));
            } else {
              puts(((const char *)"Unexpected value in cast tree"));
              exit(-1);
              return 0;
            }
          }
        }
      }
    } else {
      if (u12_type1 == 15) {
        if (7 == u13_type2) {
          u113_tmp_value = (u11_val << 3);
          return (u113_tmp_value + 1);
        } else {
          puts(((const char *)u14_label));
          exit(-1);
          return 0;
        }
      } else {
        if (u12_type1 == 23) {
          if (7 == u13_type2) {
            u114_tmp_value = (u11_val << 3);
            return (u114_tmp_value + 7);
          } else {
            puts(((const char *)u14_label));
            exit(-1);
            return 0;
          }
        } else {
          if (u12_type1 == 31) {
            if (7 == u13_type2) {
              u61_dyn_box_init = u11_val;
              u62_dyn_box_init = 31;
              u63_dyn_box =
                  (long)(posix_memalign(&alloc_ptr, 8, 8 * 2), alloc_ptr);
              ((long *)u63_dyn_box)[0] = u61_dyn_box_init;
              ((long *)u63_dyn_box)[1] = u62_dyn_box_init;
              return u63_dyn_box;
            } else {
              puts(((const char *)u14_label));
              exit(-1);
              return 0;
            }
          } else {
            u26_tag1 = (u12_type1 & 7);
            if (0 == u26_tag1) {
              if (7 == u13_type2) {
                u64_dyn_box_init = u11_val;
                u65_dyn_box_init = u12_type1;
                u66_dyn_box =
                    (long)(posix_memalign(&alloc_ptr, 8, 8 * 2), alloc_ptr);
                ((long *)u66_dyn_box)[0] = u64_dyn_box_init;
                ((long *)u66_dyn_box)[1] = u65_dyn_box_init;
                return u66_dyn_box;
              } else {
                u28_tag2 = (u13_type2 & 7);
                if (u28_tag2 == 0) {
                  u47_tmp_clos = ((long *)u11_val)[1];
                  u115_tmp_value = ((long *)u47_tmp_clos)[0];
                  return ((
                      (long (*)(long, long, long, long, long))u115_tmp_value)(
                      u47_tmp_clos, u11_val, u12_type1, u13_type2, u14_label));
                } else {
                  puts(((const char *)u14_label));
                  exit(-1);
                  return 0;
                }
              }
            } else {
              if (1 == u26_tag1) {
                if (7 == u13_type2) {
                  u67_dyn_box_init = u11_val;
                  u68_dyn_box_init = u12_type1;
                  u69_dyn_box =
                      (long)(posix_memalign(&alloc_ptr, 8, 8 * 2), alloc_ptr);
                  ((long *)u69_dyn_box)[0] = u67_dyn_box_init;
                  ((long *)u69_dyn_box)[1] = u68_dyn_box_init;
                  return u69_dyn_box;
                } else {
                  u33_tag_gref = (u13_type2 & 7);
                  if (u33_tag_gref == 1) {
                    u116_tmp_value = (u12_type1 ^ 1);
                    u34_g1 = ((long *)u116_tmp_value)[0];
                    u117_tmp_value = (u13_type2 ^ 1);
                    u35_g2 = ((long *)u117_tmp_value)[0];
                    u71_for = u11_val;
                    u72_from = u34_g1;
                    u73_to = u35_g2;
                    u74_blames = u14_label;
                    u70_gproxy =
                        (long)(posix_memalign(&alloc_ptr, 8, 8 * 4), alloc_ptr);
                    ((long *)u70_gproxy)[0] = u71_for;
                    ((long *)u70_gproxy)[1] = u72_from;
                    ((long *)u70_gproxy)[2] = u73_to;
                    ((long *)u70_gproxy)[3] = u74_blames;
                    return (u70_gproxy | 1);
                  } else {
                    puts(((const char *)u14_label));
                    exit(-1);
                    return 0;
                  }
                }
              } else {
                puts(((const char *)"Unexpected Type1 in cast tree"));
                exit(-1);
                return 0;
              }
            }
          }
        }
      }
    }
  }
}
