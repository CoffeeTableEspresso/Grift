// fn-app-x1.schml should return #(struct:Int) generated by the schml compiler.

// This is the boiler plate
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <sys/time.h>

int64_t read_int();
void *alloc_ptr;
long free_ptr;
long limit;
unsigned long allocd_mem;

long alloc(int n) {
  long result = free_ptr;
  long newFree = result + n;
  allocd_mem += n;
  if (newFree >= limit) {
    puts("Requesting more memory\n");
    free_ptr = (long)(posix_memalign(&alloc_ptr, 8, 1048576), alloc_ptr);
    if (free_ptr == (long)NULL) {
      fputs("couldn't allocate any more memory", stderr);
      exit(EXIT_FAILURE);
    }
    limit = free_ptr + 1048576;
    return alloc(n);
  }
  free_ptr = newFree;
  return result;
}
// This is the global state for the timer
struct timeval timer_start_time;
struct timeval timer_stop_time;
struct timeval timer_result_time;
int timer_started = 1;
int timer_stopped = 1;

void timer_report() {

  // some very minor error checking
  if (timer_started) {
    printf("error starting timer");
    exit(-1);
  }
  if (timer_stopped) {
    printf("error stopping timer");
    exit(-1);
  }

  double t1 = timer_start_time.tv_sec + (timer_start_time.tv_usec / 1.0e6);
  double t2 = timer_stop_time.tv_sec + (timer_stop_time.tv_usec / 1.0e6);
  printf("time (sec): %lf\n", t2 - t1);
}

// These are the variable declarations

// These are the declarations
int64_t u3_run_test(int64_t u154_run_test_clos, int64_t u5_i, int64_t u4_acc);
int64_t u0_id1(int64_t u152_id1_clos, int64_t u2_x);
int64_t u9_fn_cast_1(int64_t u10_f, int64_t u11_t1, int64_t u12_t2,
                     int64_t u13_lbl);
int64_t u145_annon(int64_t u149_annon_clos, int64_t u14_v);
int64_t u15_fn_cast_2(int64_t u16_f, int64_t u17_t1, int64_t u18_t2,
                      int64_t u19_lbl);
int64_t u144_annon(int64_t u146_annon_clos, int64_t u20_v, int64_t u21_v);
int64_t u79_gvec_set(int64_t u85_vec, int64_t u86_index, int64_t u87_value);
int64_t u78_gvec_ref(int64_t u83_vec, int64_t u84_index);
int64_t u77_gbox_set(int64_t u81_box, int64_t u82_value);
int64_t u76_gbox_ref(int64_t u80_box);
int64_t u22_cast_function(int64_t u23_value, int64_t u24_type1,
                          int64_t u25_type2, int64_t u26_blame_info);
int64_t u30_cast_gbox(int64_t u31_value, int64_t u32_type1, int64_t u33_type2,
                      int64_t u34_blame_info);
int64_t u38_cast_gvec(int64_t u39_value, int64_t u40_type1, int64_t u41_type2,
                      int64_t u42_blame_info);
int64_t u47_cast_tuple(int64_t u48_value, int64_t u49_type1, int64_t u50_type2,
                       int64_t u51_blame_info);
int64_t u55_cast_ground(int64_t u56_value, int64_t u57_type1, int64_t u58_type2,
                        int64_t u59_blame_info);
int64_t u61_cast_undyned(int64_t u62_value, int64_t u63_type1,
                         int64_t u64_type2, int64_t u65_blame_info);
int64_t u66_cast_dyn(int64_t u67_value, int64_t u68_type1, int64_t u69_type2,
                     int64_t u70_blame_info);
int64_t u46_interp_cast(int64_t u72_value, int64_t u73_type1, int64_t u74_type2,
                        int64_t u75_blame_info);
int64_t u120_dyn_gvec_set(int64_t u121_vector, int64_t u122_index,
                          int64_t u123_write_val, int64_t u124_val_type,
                          int64_t u125_blame_info);
int64_t u116_dyn_gvec_ref(int64_t u117_vector, int64_t u118_index,
                          int64_t u119_blame_info);
int64_t u111_dyn_gbox_set(int64_t u112_box, int64_t u113_write_val,
                          int64_t u114_val_type, int64_t u115_blame_info);
int64_t u108_dyn_gbox_ref(int64_t u109_box, int64_t u110_blame_info);
int64_t u171_cast(int64_t u172_val, int64_t u173_tuple_type1,
                  int64_t u174_tuple_type2, int64_t u175_label,
                  int64_t u176_index, int64_t u177_tuple_type_num);

// Obviously this is the main function
int main() {
  int64_t u218_stop;
  int64_t u217_start;
  int64_t u216_tmp_value;
  int64_t u215_tmp_value;
  int64_t u8_time_tmp;
  int64_t u214_result;
  int64_t u1_iters;
  int64_t u153_id1_clos;
  int64_t u7_acc;
  int64_t u155_run_test_clos;
  int64_t u6_i;
  free_ptr = (long)(posix_memalign(&alloc_ptr, 8, 1048576), alloc_ptr);
  limit = free_ptr + 1048576;
  allocd_mem = 0;

  u1_iters = read_int();
  u153_id1_clos = alloc(8 * 2);
  ((long *)u153_id1_clos)[0] = ((long)u0_id1);
  ((long *)u153_id1_clos)[1] = ((long)u9_fn_cast_1);
  u155_run_test_clos = alloc(8 * 3);
  ((long *)u155_run_test_clos)[0] = ((long)u3_run_test);
  ((long *)u155_run_test_clos)[1] = ((long)u15_fn_cast_2);
  ((long *)u155_run_test_clos)[2] = u153_id1_clos;
  timer_started = gettimeofday(&timer_start_time, NULL);
  u7_acc = 0;
  u217_start = 0;
  u218_stop = u1_iters;
  for (u6_i = u217_start; u6_i < u218_stop; u6_i += 1) {
    u215_tmp_value = (-8 & u155_run_test_clos);
    u216_tmp_value = ((long *)u215_tmp_value)[0];
    u7_acc = (((int64_t(*)(int64_t, int64_t, int64_t))u216_tmp_value)(
        u155_run_test_clos, u6_i, u7_acc));
  };
  u8_time_tmp = u7_acc;
  timer_stopped = gettimeofday(&timer_stop_time, NULL);
  timer_report();
  u214_result = u8_time_tmp;
  printf("Int : %d\n", (void *)u214_result);
  return 0;
}

// Here are all the definitions for Subroutines
int64_t u3_run_test(int64_t u154_run_test_clos, int64_t u5_i, int64_t u4_acc) {
  int64_t u222_tmp_value;
  int64_t u221_tmp_value;
  int64_t u220_tmp_value;
  int64_t u219_tmp_value;
  int64_t u156_tmp_closure;
  u219_tmp_value = (u154_run_test_clos & -8);
  u156_tmp_closure = ((long *)u219_tmp_value)[2];
  u220_tmp_value = (-8 & u156_tmp_closure);
  u221_tmp_value = ((long *)u220_tmp_value)[0];
  u222_tmp_value = (1 + u4_acc);
  return (((int64_t(*)(int64_t, int64_t))u221_tmp_value)(u156_tmp_closure,
                                                         u222_tmp_value));
}

int64_t u0_id1(int64_t u152_id1_clos, int64_t u2_x) { return u2_x; }

int64_t u9_fn_cast_1(int64_t u10_f, int64_t u11_t1, int64_t u12_t2,
                     int64_t u13_lbl) {
  int64_t u150_annon_clos;
  u150_annon_clos = alloc(8 * 6);
  ((long *)u150_annon_clos)[0] = ((long)u145_annon);
  ((long *)u150_annon_clos)[1] = ((long)u9_fn_cast_1);
  ((long *)u150_annon_clos)[2] = u10_f;
  ((long *)u150_annon_clos)[3] = u11_t1;
  ((long *)u150_annon_clos)[4] = u13_lbl;
  ((long *)u150_annon_clos)[5] = u12_t2;
  return u150_annon_clos;
}

int64_t u145_annon(int64_t u149_annon_clos, int64_t u14_v) {
  int64_t u243_tmp_value;
  int64_t u242_tmp_value;
  int64_t u241_tmp_value;
  int64_t u240_tmp_value;
  int64_t u239_tmp_value;
  int64_t u238_tmp_value;
  int64_t u237_tmp_value;
  int64_t u236_tmp_value;
  int64_t u235_tmp_value;
  int64_t u234_tmp_value;
  int64_t u233_tmp_value;
  int64_t u232_tmp_value;
  int64_t u231_tmp_value;
  int64_t u230_tmp_value;
  int64_t u229_tmp_value;
  int64_t u228_tmp_value;
  int64_t u227_tmp_value;
  int64_t u226_tmp_value;
  int64_t u225_tmp_value;
  int64_t u224_tmp_value;
  int64_t u223_tmp_value;
  int64_t u151_tmp_closure;
  u223_tmp_value = (u149_annon_clos & -8);
  u151_tmp_closure = ((long *)u223_tmp_value)[2];
  u224_tmp_value = (-8 & u151_tmp_closure);
  u225_tmp_value = ((long *)u224_tmp_value)[0];
  u226_tmp_value = (u149_annon_clos & -8);
  u227_tmp_value = ((long *)u226_tmp_value)[5];
  u228_tmp_value = ((long *)u227_tmp_value)[2];
  u229_tmp_value = (u149_annon_clos & -8);
  u230_tmp_value = ((long *)u229_tmp_value)[3];
  u231_tmp_value = ((long *)u230_tmp_value)[2];
  u232_tmp_value = (u149_annon_clos & -8);
  u233_tmp_value = ((long *)u232_tmp_value)[4];
  u234_tmp_value =
      (u46_interp_cast(u14_v, u228_tmp_value, u231_tmp_value, u233_tmp_value));
  u235_tmp_value = (((int64_t(*)(int64_t, int64_t))u225_tmp_value)(
      u151_tmp_closure, u234_tmp_value));
  u236_tmp_value = (u149_annon_clos & -8);
  u237_tmp_value = ((long *)u236_tmp_value)[3];
  u238_tmp_value = ((long *)u237_tmp_value)[1];
  u239_tmp_value = (u149_annon_clos & -8);
  u240_tmp_value = ((long *)u239_tmp_value)[5];
  u241_tmp_value = ((long *)u240_tmp_value)[1];
  u242_tmp_value = (u149_annon_clos & -8);
  u243_tmp_value = ((long *)u242_tmp_value)[4];
  return (u46_interp_cast(u235_tmp_value, u238_tmp_value, u241_tmp_value,
                          u243_tmp_value));
}

int64_t u15_fn_cast_2(int64_t u16_f, int64_t u17_t1, int64_t u18_t2,
                      int64_t u19_lbl) {
  int64_t u147_annon_clos;
  u147_annon_clos = alloc(8 * 6);
  ((long *)u147_annon_clos)[0] = ((long)u144_annon);
  ((long *)u147_annon_clos)[1] = ((long)u15_fn_cast_2);
  ((long *)u147_annon_clos)[2] = u19_lbl;
  ((long *)u147_annon_clos)[3] = u16_f;
  ((long *)u147_annon_clos)[4] = u18_t2;
  ((long *)u147_annon_clos)[5] = u17_t1;
  return u147_annon_clos;
}

int64_t u144_annon(int64_t u146_annon_clos, int64_t u20_v, int64_t u21_v) {
  int64_t u273_tmp_value;
  int64_t u272_tmp_value;
  int64_t u271_tmp_value;
  int64_t u270_tmp_value;
  int64_t u269_tmp_value;
  int64_t u268_tmp_value;
  int64_t u267_tmp_value;
  int64_t u266_tmp_value;
  int64_t u265_tmp_value;
  int64_t u264_tmp_value;
  int64_t u263_tmp_value;
  int64_t u262_tmp_value;
  int64_t u261_tmp_value;
  int64_t u260_tmp_value;
  int64_t u259_tmp_value;
  int64_t u258_tmp_value;
  int64_t u257_tmp_value;
  int64_t u256_tmp_value;
  int64_t u255_tmp_value;
  int64_t u254_tmp_value;
  int64_t u253_tmp_value;
  int64_t u252_tmp_value;
  int64_t u251_tmp_value;
  int64_t u250_tmp_value;
  int64_t u249_tmp_value;
  int64_t u248_tmp_value;
  int64_t u247_tmp_value;
  int64_t u246_tmp_value;
  int64_t u245_tmp_value;
  int64_t u244_tmp_value;
  int64_t u148_tmp_closure;
  u244_tmp_value = (u146_annon_clos & -8);
  u148_tmp_closure = ((long *)u244_tmp_value)[3];
  u245_tmp_value = (-8 & u148_tmp_closure);
  u246_tmp_value = ((long *)u245_tmp_value)[0];
  u247_tmp_value = (u146_annon_clos & -8);
  u248_tmp_value = ((long *)u247_tmp_value)[4];
  u249_tmp_value = ((long *)u248_tmp_value)[2];
  u250_tmp_value = (u146_annon_clos & -8);
  u251_tmp_value = ((long *)u250_tmp_value)[5];
  u252_tmp_value = ((long *)u251_tmp_value)[2];
  u253_tmp_value = (u146_annon_clos & -8);
  u254_tmp_value = ((long *)u253_tmp_value)[2];
  u255_tmp_value =
      (u46_interp_cast(u20_v, u249_tmp_value, u252_tmp_value, u254_tmp_value));
  u256_tmp_value = (u146_annon_clos & -8);
  u257_tmp_value = ((long *)u256_tmp_value)[4];
  u258_tmp_value = ((long *)u257_tmp_value)[3];
  u259_tmp_value = (u146_annon_clos & -8);
  u260_tmp_value = ((long *)u259_tmp_value)[5];
  u261_tmp_value = ((long *)u260_tmp_value)[3];
  u262_tmp_value = (u146_annon_clos & -8);
  u263_tmp_value = ((long *)u262_tmp_value)[2];
  u264_tmp_value =
      (u46_interp_cast(u21_v, u258_tmp_value, u261_tmp_value, u263_tmp_value));
  u265_tmp_value = (((int64_t(*)(int64_t, int64_t, int64_t))u246_tmp_value)(
      u148_tmp_closure, u255_tmp_value, u264_tmp_value));
  u266_tmp_value = (u146_annon_clos & -8);
  u267_tmp_value = ((long *)u266_tmp_value)[5];
  u268_tmp_value = ((long *)u267_tmp_value)[1];
  u269_tmp_value = (u146_annon_clos & -8);
  u270_tmp_value = ((long *)u269_tmp_value)[4];
  u271_tmp_value = ((long *)u270_tmp_value)[1];
  u272_tmp_value = (u146_annon_clos & -8);
  u273_tmp_value = ((long *)u272_tmp_value)[2];
  return (u46_interp_cast(u265_tmp_value, u268_tmp_value, u271_tmp_value,
                          u273_tmp_value));
}

int64_t u79_gvec_set(int64_t u85_vec, int64_t u86_index, int64_t u87_value) {
  int64_t u280_tmp_value;
  int64_t u279_tmp_value;
  int64_t u278_tmp_value;
  int64_t u277_tmp_value;
  int64_t u276_tmp_value;
  int64_t u275_tmp_value;
  int64_t u274_tmp_value;
  int64_t u105_gvec_set_proxied_target_type;
  int64_t u213_ugvect;
  int64_t u104_gvec_set_proxied_source_type;
  int64_t u107_gvec_set_write_value;
  int64_t u212_index;
  int64_t u106_gvec_set_proxied_blame_info;
  int64_t u103_gvec_set_proxied_vector;
  u274_tmp_value = (u85_vec & 7);
  if (u274_tmp_value == 1) {
    u275_tmp_value = (u85_vec ^ 1);
    u103_gvec_set_proxied_vector = ((long *)u275_tmp_value)[0];
    u276_tmp_value = (u85_vec ^ 1);
    u104_gvec_set_proxied_source_type = ((long *)u276_tmp_value)[1];
    u277_tmp_value = (u85_vec ^ 1);
    u105_gvec_set_proxied_target_type = ((long *)u277_tmp_value)[2];
    u278_tmp_value = (u85_vec ^ 1);
    u106_gvec_set_proxied_blame_info = ((long *)u278_tmp_value)[3];
    u107_gvec_set_write_value = (u46_interp_cast(
        u87_value, u105_gvec_set_proxied_target_type,
        u104_gvec_set_proxied_source_type, u106_gvec_set_proxied_blame_info));
    return (u79_gvec_set(u103_gvec_set_proxied_vector, u86_index,
                         u107_gvec_set_write_value));
  } else {
    u212_index = u86_index;
    if (u212_index >= 0) {
      u213_ugvect = u85_vec;
      u279_tmp_value = ((long *)u213_ugvect)[0];
      if (u212_index < u279_tmp_value) {
        u280_tmp_value = (u212_index + 1);
        ((long *)u213_ugvect)[u280_tmp_value] = u87_value;
        return 0;
      } else {
        printf("index out of bound %l\n", (void *)u212_index);
        exit(-1);
        return 0;
      }
    } else {
      printf("index out of bound %l\n", (void *)u212_index);
      exit(-1);
      return 0;
    }
  }
}

int64_t u78_gvec_ref(int64_t u83_vec, int64_t u84_index) {
  int64_t u287_tmp_value;
  int64_t u286_tmp_value;
  int64_t u285_tmp_value;
  int64_t u284_tmp_value;
  int64_t u283_tmp_value;
  int64_t u282_tmp_value;
  int64_t u281_tmp_value;
  int64_t u100_gvec_ref_proxied_target_type;
  int64_t u211_e;
  int64_t u98_gvec_ref_proxied_vector;
  int64_t u102_gvec_ref_read_value;
  int64_t u210_index;
  int64_t u101_gvec_ref_proxied_blame_info;
  int64_t u99_gvec_ref_proxied_source_type;
  u281_tmp_value = (u83_vec & 7);
  if (u281_tmp_value == 1) {
    u282_tmp_value = (u83_vec ^ 1);
    u98_gvec_ref_proxied_vector = ((long *)u282_tmp_value)[0];
    u283_tmp_value = (u83_vec ^ 1);
    u99_gvec_ref_proxied_source_type = ((long *)u283_tmp_value)[1];
    u284_tmp_value = (u83_vec ^ 1);
    u100_gvec_ref_proxied_target_type = ((long *)u284_tmp_value)[2];
    u285_tmp_value = (u83_vec ^ 1);
    u101_gvec_ref_proxied_blame_info = ((long *)u285_tmp_value)[3];
    u102_gvec_ref_read_value =
        (u78_gvec_ref(u98_gvec_ref_proxied_vector, u84_index));
    return (u46_interp_cast(
        u102_gvec_ref_read_value, u99_gvec_ref_proxied_source_type,
        u100_gvec_ref_proxied_target_type, u101_gvec_ref_proxied_blame_info));
  } else {
    u210_index = u84_index;
    u211_e = u83_vec;
    if (u210_index >= 0) {
      u286_tmp_value = ((long *)u211_e)[0];
      if (u210_index < u286_tmp_value) {
        u287_tmp_value = (u210_index + 1);
        return ((long *)u211_e)[u287_tmp_value];
      } else {
        printf("index out of bound %l\n", (void *)u210_index);
        exit(-1);
        return 0;
      }
    } else {
      printf("index out of bound %l\n", (void *)u210_index);
      exit(-1);
      return 0;
    }
  }
}

int64_t u77_gbox_set(int64_t u81_box, int64_t u82_value) {
  int64_t u292_tmp_value;
  int64_t u291_tmp_value;
  int64_t u290_tmp_value;
  int64_t u289_tmp_value;
  int64_t u288_tmp_value;
  int64_t u96_gbox_set_proxied_blame_info;
  int64_t u93_gbox_set_proxied_box;
  int64_t u95_gbox_set_proxied_target_type;
  int64_t u97_gbox_set_write_value;
  int64_t u94_gbox_set_proxied_source_type;
  u288_tmp_value = (u81_box & 7);
  if (u288_tmp_value == 1) {
    u289_tmp_value = (u81_box ^ 1);
    u93_gbox_set_proxied_box = ((long *)u289_tmp_value)[0];
    u290_tmp_value = (u81_box ^ 1);
    u94_gbox_set_proxied_source_type = ((long *)u290_tmp_value)[1];
    u291_tmp_value = (u81_box ^ 1);
    u95_gbox_set_proxied_target_type = ((long *)u291_tmp_value)[2];
    u292_tmp_value = (u81_box ^ 1);
    u96_gbox_set_proxied_blame_info = ((long *)u292_tmp_value)[3];
    u97_gbox_set_write_value = (u46_interp_cast(
        u82_value, u95_gbox_set_proxied_target_type,
        u94_gbox_set_proxied_source_type, u96_gbox_set_proxied_blame_info));
    return (u77_gbox_set(u93_gbox_set_proxied_box, u97_gbox_set_write_value));
  } else {
    ((long *)u81_box)[0] = u82_value;
    return 0;
  }
}

int64_t u76_gbox_ref(int64_t u80_box) {
  int64_t u297_tmp_value;
  int64_t u296_tmp_value;
  int64_t u295_tmp_value;
  int64_t u294_tmp_value;
  int64_t u293_tmp_value;
  int64_t u92_gbox_ref_read_value;
  int64_t u91_gbox_ref_proxied_blame_info;
  int64_t u90_gbox_ref_proxied_target_type;
  int64_t u88_gbox_ref_proxied_box;
  int64_t u89_gbox_ref_proxied_source_type;
  u293_tmp_value = (u80_box & 7);
  if (u293_tmp_value == 1) {
    u294_tmp_value = (u80_box ^ 1);
    u88_gbox_ref_proxied_box = ((long *)u294_tmp_value)[0];
    u295_tmp_value = (u80_box ^ 1);
    u89_gbox_ref_proxied_source_type = ((long *)u295_tmp_value)[1];
    u296_tmp_value = (u80_box ^ 1);
    u90_gbox_ref_proxied_target_type = ((long *)u296_tmp_value)[2];
    u297_tmp_value = (u80_box ^ 1);
    u91_gbox_ref_proxied_blame_info = ((long *)u297_tmp_value)[3];
    u92_gbox_ref_read_value = (u76_gbox_ref(u88_gbox_ref_proxied_box));
    return (u46_interp_cast(
        u92_gbox_ref_read_value, u89_gbox_ref_proxied_source_type,
        u90_gbox_ref_proxied_target_type, u91_gbox_ref_proxied_blame_info));
  } else {
    return ((long *)u80_box)[0];
  }
}

int64_t u22_cast_function(int64_t u23_value, int64_t u24_type1,
                          int64_t u25_type2, int64_t u26_blame_info) {
  int64_t u299_tmp_value;
  int64_t u298_tmp_value;
  int64_t u206_type;
  int64_t u207_tag;
  int64_t u205_value;
  int64_t u27_tag2;
  int64_t u28_type1_arity;
  int64_t u209_dynamic_boxed;
  int64_t u208_imm;
  int64_t u29_type2_arity;
  if (7 == u25_type2) {
    u205_value = u23_value;
    u206_type = u24_type1;
    u207_tag = (u206_type & 7);
    if (u207_tag == 7) {
      u208_imm = (u205_value << 3);
      if (u206_type == 15) {
        return (u208_imm | 1);
      } else {
        if (u206_type == 23) {
          return (u208_imm | 7);
        } else {
          return (u208_imm | 2);
        }
      }
    } else {
      u209_dynamic_boxed = alloc(8 * 2);
      ((long *)u209_dynamic_boxed)[0] = u205_value;
      ((long *)u209_dynamic_boxed)[1] = u206_type;
      return u209_dynamic_boxed;
    }
  } else {
    u27_tag2 = (u25_type2 & 7);
    if (u27_tag2 == 0) {
      u28_type1_arity = ((long *)u24_type1)[0];
      u29_type2_arity = ((long *)u25_type2)[0];
      if (u28_type1_arity == u29_type2_arity) {
        u298_tmp_value = (-8 & u23_value);
        u299_tmp_value = ((long *)u298_tmp_value)[1];
        return (
            ((int64_t(*)(int64_t, int64_t, int64_t, int64_t))u299_tmp_value)(
                u23_value, u24_type1, u25_type2, u26_blame_info));
      } else {
        puts(((const char *)u26_blame_info));
        exit(-1);
        return 0;
      }
    } else {
      puts(((const char *)u26_blame_info));
      exit(-1);
      return 0;
    }
  }
}

int64_t u30_cast_gbox(int64_t u31_value, int64_t u32_type1, int64_t u33_type2,
                      int64_t u34_blame_info) {
  int64_t u301_tmp_value;
  int64_t u300_tmp_value;
  int64_t u199_dynamic_boxed;
  int64_t u202_source_t;
  int64_t u37_g2;
  int64_t u204_blame;
  int64_t u195_value;
  int64_t u197_tag;
  int64_t u198_imm;
  int64_t u203_target_t;
  int64_t u201_guarded_ref;
  int64_t u200_guarded_proxy;
  int64_t u36_g1;
  int64_t u196_type;
  int64_t u35_tag_gref;
  if (7 == u33_type2) {
    u195_value = u31_value;
    u196_type = u32_type1;
    u197_tag = (u196_type & 7);
    if (u197_tag == 7) {
      u198_imm = (u195_value << 3);
      if (u196_type == 15) {
        return (u198_imm | 1);
      } else {
        if (u196_type == 23) {
          return (u198_imm | 7);
        } else {
          return (u198_imm | 2);
        }
      }
    } else {
      u199_dynamic_boxed = alloc(8 * 2);
      ((long *)u199_dynamic_boxed)[0] = u195_value;
      ((long *)u199_dynamic_boxed)[1] = u196_type;
      return u199_dynamic_boxed;
    }
  } else {
    u35_tag_gref = (u33_type2 & 7);
    if (u35_tag_gref == 1) {
      u300_tmp_value = (u32_type1 ^ 1);
      u36_g1 = ((long *)u300_tmp_value)[0];
      u301_tmp_value = (u33_type2 ^ 1);
      u37_g2 = ((long *)u301_tmp_value)[0];
      u201_guarded_ref = u31_value;
      u202_source_t = u36_g1;
      u203_target_t = u37_g2;
      u204_blame = u34_blame_info;
      u200_guarded_proxy = alloc(8 * 4);
      ((long *)u200_guarded_proxy)[0] = u201_guarded_ref;
      ((long *)u200_guarded_proxy)[1] = u202_source_t;
      ((long *)u200_guarded_proxy)[2] = u203_target_t;
      ((long *)u200_guarded_proxy)[3] = u204_blame;
      return (u200_guarded_proxy | 1);
    } else {
      puts(((const char *)u34_blame_info));
      exit(-1);
      return 0;
    }
  }
}

int64_t u38_cast_gvec(int64_t u39_value, int64_t u40_type1, int64_t u41_type2,
                      int64_t u42_blame_info) {
  int64_t u303_tmp_value;
  int64_t u302_tmp_value;
  int64_t u185_value;
  int64_t u189_dynamic_boxed;
  int64_t u191_guarded_ref;
  int64_t u186_type;
  int64_t u190_guarded_proxy;
  int64_t u194_blame;
  int64_t u44_g1;
  int64_t u45_g2;
  int64_t u187_tag;
  int64_t u192_source_t;
  int64_t u188_imm;
  int64_t u43_tag_gvect;
  int64_t u193_target_t;
  if (7 == u41_type2) {
    u185_value = u39_value;
    u186_type = u40_type1;
    u187_tag = (u186_type & 7);
    if (u187_tag == 7) {
      u188_imm = (u185_value << 3);
      if (u186_type == 15) {
        return (u188_imm | 1);
      } else {
        if (u186_type == 23) {
          return (u188_imm | 7);
        } else {
          return (u188_imm | 2);
        }
      }
    } else {
      u189_dynamic_boxed = alloc(8 * 2);
      ((long *)u189_dynamic_boxed)[0] = u185_value;
      ((long *)u189_dynamic_boxed)[1] = u186_type;
      return u189_dynamic_boxed;
    }
  } else {
    u43_tag_gvect = (u41_type2 & 7);
    if (u43_tag_gvect == 2) {
      u302_tmp_value = (u40_type1 ^ 2);
      u44_g1 = ((long *)u302_tmp_value)[0];
      u303_tmp_value = (u41_type2 ^ 2);
      u45_g2 = ((long *)u303_tmp_value)[0];
      u191_guarded_ref = u39_value;
      u192_source_t = u44_g1;
      u193_target_t = u45_g2;
      u194_blame = u42_blame_info;
      u190_guarded_proxy = alloc(8 * 4);
      ((long *)u190_guarded_proxy)[0] = u191_guarded_ref;
      ((long *)u190_guarded_proxy)[1] = u192_source_t;
      ((long *)u190_guarded_proxy)[2] = u193_target_t;
      ((long *)u190_guarded_proxy)[3] = u194_blame;
      return (u190_guarded_proxy | 1);
    } else {
      puts(((const char *)u42_blame_info));
      exit(-1);
      return 0;
    }
  }
}

int64_t u47_cast_tuple(int64_t u48_value, int64_t u49_type1, int64_t u50_type2,
                       int64_t u51_blame_info) {
  int64_t u306_tmp_value;
  int64_t u305_tmp_value;
  int64_t u304_tmp_value;
  int64_t u169_imm;
  int64_t u52_tag2;
  int64_t u184_num;
  int64_t u167_type;
  int64_t u166_value;
  int64_t u53_type1_num;
  int64_t u170_dynamic_boxed;
  int64_t u168_tag;
  int64_t u54_type2_num;
  if (7 == u50_type2) {
    u166_value = u48_value;
    u167_type = u49_type1;
    u168_tag = (u167_type & 7);
    if (u168_tag == 7) {
      u169_imm = (u166_value << 3);
      if (u167_type == 15) {
        return (u169_imm | 1);
      } else {
        if (u167_type == 23) {
          return (u169_imm | 7);
        } else {
          return (u169_imm | 2);
        }
      }
    } else {
      u170_dynamic_boxed = alloc(8 * 2);
      ((long *)u170_dynamic_boxed)[0] = u166_value;
      ((long *)u170_dynamic_boxed)[1] = u167_type;
      return u170_dynamic_boxed;
    }
  } else {
    u52_tag2 = (u50_type2 & 7);
    if (u52_tag2 == 3) {
      u304_tmp_value = (u49_type1 ^ 3);
      u53_type1_num = ((long *)u304_tmp_value)[0];
      u305_tmp_value = (u50_type2 ^ 3);
      u54_type2_num = ((long *)u305_tmp_value)[0];
      if (u54_type2_num <= u53_type1_num) {
        u306_tmp_value = (u50_type2 ^ 3);
        u184_num = ((long *)u306_tmp_value)[0];
        return (u171_cast(u48_value, u49_type1, u50_type2, u51_blame_info, 0,
                          u184_num));
      } else {
        puts(((const char *)u54_type2_num));
        exit(-1);
        return 0;
      }
    } else {
      puts(((const char *)u51_blame_info));
      exit(-1);
      return 0;
    }
  }
}

int64_t u55_cast_ground(int64_t u56_value, int64_t u57_type1, int64_t u58_type2,
                        int64_t u59_blame_info) {
  int64_t u309_tmp_value;
  int64_t u308_tmp_value;
  int64_t u307_tmp_value;
  int64_t u60_tag1;
  if (u57_type1 == 15) {
    if (7 == u58_type2) {
      u307_tmp_value = (u56_value << 3);
      return (u307_tmp_value + 1);
    } else {
      puts(((const char *)u59_blame_info));
      exit(-1);
      return 0;
    }
  } else {
    if (u57_type1 == 23) {
      if (7 == u58_type2) {
        u308_tmp_value = (u56_value << 3);
        return (u308_tmp_value + 7);
      } else {
        puts(((const char *)u59_blame_info));
        exit(-1);
        return 0;
      }
    } else {
      if (u57_type1 == 31) {
        if (7 == u58_type2) {
          u309_tmp_value = (u56_value << 3);
          return (u309_tmp_value + 2);
        } else {
          puts(((const char *)u59_blame_info));
          exit(-1);
          return 0;
        }
      } else {
        u60_tag1 = (u57_type1 & 7);
        if (0 == u60_tag1) {
          return (u22_cast_function(u56_value, u57_type1, u58_type2,
                                    u59_blame_info));
        } else {
          if (1 == u60_tag1) {
            return (
                u30_cast_gbox(u56_value, u57_type1, u58_type2, u59_blame_info));
          } else {
            if (2 == u60_tag1) {
              return (u38_cast_gvec(u56_value, u57_type1, u58_type2,
                                    u59_blame_info));
            } else {
              if (3 == u60_tag1) {
                return (u47_cast_tuple(u56_value, u57_type1, u58_type2,
                                       u59_blame_info));
              } else {
                puts(((const char *)"Unexpected Type1 in cast tree"));
                exit(-1);
                return 0;
              }
            }
          }
        }
      }
    }
  }
}

int64_t u61_cast_undyned(int64_t u62_value, int64_t u63_type1,
                         int64_t u64_type2, int64_t u65_blame_info) {
  if (u63_type1 == u64_type2) {
    return u62_value;
  } else {
    return (u55_cast_ground(u62_value, u63_type1, u64_type2, u65_blame_info));
  }
}

int64_t u66_cast_dyn(int64_t u67_value, int64_t u68_type1, int64_t u69_type2,
                     int64_t u70_blame_info) {
  int64_t u318_tmp;
  int64_t u317_tmp;
  int64_t u316_tmp;
  int64_t u315_tmp_value;
  int64_t u314_tmp;
  int64_t u313_tmp_value;
  int64_t u312_tmp_value;
  int64_t u311_tmp_value;
  int64_t u310_tmp_value;
  int64_t u164_tmp;
  int64_t u163_dyn_value_tag;
  int64_t u71_tag;
  int64_t u165_tag;
  int64_t u162_dyn_value_tmp;
  u71_tag = (u67_value & 7);
  if (1 == u71_tag) {
    u310_tmp_value = (u67_value >> 3);
    return (u61_cast_undyned(u310_tmp_value, 15, u69_type2, u70_blame_info));
  } else {
    if (7 == u71_tag) {
      u311_tmp_value = (u67_value >> 3);
      return (u61_cast_undyned(u311_tmp_value, 23, u69_type2, u70_blame_info));
    } else {
      if (2 == u71_tag) {
        return (u61_cast_undyned(0, 31, u69_type2, u70_blame_info));
      } else {
        if (0 == u71_tag) {
          u162_dyn_value_tmp = u67_value;
          u163_dyn_value_tag = (u162_dyn_value_tmp & 7);
          if (u163_dyn_value_tag == 0) {
            u312_tmp_value = ((long *)u162_dyn_value_tmp)[0];
            u314_tmp = u312_tmp_value;
          } else {
            u313_tmp_value = (u162_dyn_value_tmp >> 3);
            u314_tmp = u313_tmp_value;
          };
          u164_tmp = u67_value;
          u165_tag = (u164_tmp & 7);
          if (u165_tag == 0) {
            u315_tmp_value = ((long *)u164_tmp)[1];
            u318_tmp = u315_tmp_value;
          } else {
            if (u165_tag == 1) {
              u317_tmp = 15;
            } else {
              if (u165_tag == 7) {
                u316_tmp = 23;
              } else {
                u316_tmp = 31;
              };
              u317_tmp = u316_tmp;
            };
            u318_tmp = u317_tmp;
          };
          return (
              u61_cast_undyned(u314_tmp, u318_tmp, u69_type2, u70_blame_info));
        } else {
          puts(((const char *)"Unexpected value in cast tree"));
          exit(-1);
          return 0;
        }
      }
    }
  }
}

int64_t u46_interp_cast(int64_t u72_value, int64_t u73_type1, int64_t u74_type2,
                        int64_t u75_blame_info) {
  if (u73_type1 == u74_type2) {
    return u72_value;
  } else {
    if (u73_type1 == 7) {
      return (u66_cast_dyn(u72_value, u73_type1, u74_type2, u75_blame_info));
    } else {
      return (u55_cast_ground(u72_value, u73_type1, u74_type2, u75_blame_info));
    }
  }
}

int64_t u120_dyn_gvec_set(int64_t u121_vector, int64_t u122_index,
                          int64_t u123_write_val, int64_t u124_val_type,
                          int64_t u125_blame_info) {
  int64_t u321_tmp_value;
  int64_t u320_tmp_value;
  int64_t u319_tmp_value;
  int64_t u141_dyn_setbox_tyof;
  int64_t u140_dyn_setbox_ty;
  int64_t u139_dyn_setbox_gvect_value;
  int64_t u161_tag;
  int64_t u159_dyn_value_tag;
  int64_t u143_dyn_setbox_write_value3;
  int64_t u158_dyn_value_tmp;
  int64_t u160_tmp;
  u158_dyn_value_tmp = u121_vector;
  u159_dyn_value_tag = (u158_dyn_value_tmp & 7);
  if (u159_dyn_value_tag == 0) {
    u139_dyn_setbox_gvect_value = ((long *)u158_dyn_value_tmp)[0];
  } else {
    u139_dyn_setbox_gvect_value = (u158_dyn_value_tmp >> 3);
  };
  u160_tmp = u121_vector;
  u161_tag = (u160_tmp & 7);
  if (u161_tag == 0) {
    u140_dyn_setbox_ty = ((long *)u160_tmp)[1];
  } else {
    if (u161_tag == 1) {
      u140_dyn_setbox_ty = 15;
    } else {
      if (u161_tag == 7) {
        u140_dyn_setbox_ty = 23;
      } else {
        u140_dyn_setbox_ty = 31;
      };
    };
  };
  u319_tmp_value = (u140_dyn_setbox_ty & 7);
  if (u319_tmp_value == 2) {
    u320_tmp_value = (u140_dyn_setbox_ty ^ 2);
    u141_dyn_setbox_tyof = ((long *)u320_tmp_value)[0];
    u143_dyn_setbox_write_value3 = (u46_interp_cast(
        u123_write_val, u124_val_type, u141_dyn_setbox_tyof, u125_blame_info));
    u321_tmp_value = (u79_gvec_set(u139_dyn_setbox_gvect_value, u122_index,
                                   u143_dyn_setbox_write_value3));
    return (u46_interp_cast(u321_tmp_value, u141_dyn_setbox_tyof, 7,
                            u125_blame_info));
  } else {
    puts(((const char *)u125_blame_info));
    exit(-1);
    return 0;
  }
}

int64_t u116_dyn_gvec_ref(int64_t u117_vector, int64_t u118_index,
                          int64_t u119_blame_info) {
  int64_t u323_tmp_value;
  int64_t u322_tmp_value;
  int64_t u155_dyn_value_tag;
  int64_t u135_dyn_gvec_ref_val;
  int64_t u136_dyn_gvec_ref_ty;
  int64_t u157_tag;
  int64_t u138_dyn_gvec_ref_read_val;
  int64_t u137_dyn_gvec_ref_tyof;
  int64_t u156_tmp;
  int64_t u154_dyn_value_tmp;
  u154_dyn_value_tmp = u117_vector;
  u155_dyn_value_tag = (u154_dyn_value_tmp & 7);
  if (u155_dyn_value_tag == 0) {
    u135_dyn_gvec_ref_val = ((long *)u154_dyn_value_tmp)[0];
  } else {
    u135_dyn_gvec_ref_val = (u154_dyn_value_tmp >> 3);
  };
  u156_tmp = u117_vector;
  u157_tag = (u156_tmp & 7);
  if (u157_tag == 0) {
    u136_dyn_gvec_ref_ty = ((long *)u156_tmp)[1];
  } else {
    if (u157_tag == 1) {
      u136_dyn_gvec_ref_ty = 15;
    } else {
      if (u157_tag == 7) {
        u136_dyn_gvec_ref_ty = 23;
      } else {
        u136_dyn_gvec_ref_ty = 31;
      };
    };
  };
  u322_tmp_value = (u136_dyn_gvec_ref_ty & 7);
  if (u322_tmp_value == 2) {
    u323_tmp_value = (u136_dyn_gvec_ref_ty ^ 2);
    u137_dyn_gvec_ref_tyof = ((long *)u323_tmp_value)[0];
    u138_dyn_gvec_ref_read_val =
        (u78_gvec_ref(u135_dyn_gvec_ref_val, u118_index));
    return (u46_interp_cast(u138_dyn_gvec_ref_read_val, u137_dyn_gvec_ref_tyof,
                            7, u119_blame_info));
  } else {
    puts(((const char *)u119_blame_info));
    exit(-1);
    return 0;
  }
}

int64_t u111_dyn_gbox_set(int64_t u112_box, int64_t u113_write_val,
                          int64_t u114_val_type, int64_t u115_blame_info) {
  int64_t u326_tmp_value;
  int64_t u325_tmp_value;
  int64_t u324_tmp_value;
  int64_t u151_dyn_value_tag;
  int64_t u131_dyn_setbox_ty;
  int64_t u152_tmp;
  int64_t u153_tag;
  int64_t u132_dyn_setbox_tyof;
  int64_t u130_dyn_setbox_gbox;
  int64_t u134_dyn_setbox_wrt_val3;
  int64_t u150_dyn_value_tmp;
  u150_dyn_value_tmp = u112_box;
  u151_dyn_value_tag = (u150_dyn_value_tmp & 7);
  if (u151_dyn_value_tag == 0) {
    u130_dyn_setbox_gbox = ((long *)u150_dyn_value_tmp)[0];
  } else {
    u130_dyn_setbox_gbox = (u150_dyn_value_tmp >> 3);
  };
  u152_tmp = u112_box;
  u153_tag = (u152_tmp & 7);
  if (u153_tag == 0) {
    u131_dyn_setbox_ty = ((long *)u152_tmp)[1];
  } else {
    if (u153_tag == 1) {
      u131_dyn_setbox_ty = 15;
    } else {
      if (u153_tag == 7) {
        u131_dyn_setbox_ty = 23;
      } else {
        u131_dyn_setbox_ty = 31;
      };
    };
  };
  u324_tmp_value = (u131_dyn_setbox_ty & 7);
  if (u324_tmp_value == 1) {
    u325_tmp_value = (u131_dyn_setbox_ty ^ 1);
    u132_dyn_setbox_tyof = ((long *)u325_tmp_value)[0];
    u134_dyn_setbox_wrt_val3 = (u46_interp_cast(
        u113_write_val, u114_val_type, u132_dyn_setbox_tyof, u115_blame_info));
    u326_tmp_value =
        (u77_gbox_set(u130_dyn_setbox_gbox, u134_dyn_setbox_wrt_val3));
    return (u46_interp_cast(u326_tmp_value, u132_dyn_setbox_tyof, 7,
                            u115_blame_info));
  } else {
    puts(((const char *)u115_blame_info));
    exit(-1);
    return 0;
  }
}

int64_t u108_dyn_gbox_ref(int64_t u109_box, int64_t u110_blame_info) {
  int64_t u328_tmp_value;
  int64_t u327_tmp_value;
  int64_t u127_dyn_unbox_ty;
  int64_t u149_tag;
  int64_t u146_dyn_value_tmp;
  int64_t u126_dyn_unbox_val;
  int64_t u148_tmp;
  int64_t u147_dyn_value_tag;
  int64_t u129_dyn_unbox_read_val;
  int64_t u128_dyn_unbox_tyof;
  u146_dyn_value_tmp = u109_box;
  u147_dyn_value_tag = (u146_dyn_value_tmp & 7);
  if (u147_dyn_value_tag == 0) {
    u126_dyn_unbox_val = ((long *)u146_dyn_value_tmp)[0];
  } else {
    u126_dyn_unbox_val = (u146_dyn_value_tmp >> 3);
  };
  u148_tmp = u109_box;
  u149_tag = (u148_tmp & 7);
  if (u149_tag == 0) {
    u127_dyn_unbox_ty = ((long *)u148_tmp)[1];
  } else {
    if (u149_tag == 1) {
      u127_dyn_unbox_ty = 15;
    } else {
      if (u149_tag == 7) {
        u127_dyn_unbox_ty = 23;
      } else {
        u127_dyn_unbox_ty = 31;
      };
    };
  };
  u327_tmp_value = (u127_dyn_unbox_ty & 7);
  if (u327_tmp_value == 1) {
    u328_tmp_value = (u127_dyn_unbox_ty ^ 1);
    u128_dyn_unbox_tyof = ((long *)u328_tmp_value)[0];
    u129_dyn_unbox_read_val = (u76_gbox_ref(u126_dyn_unbox_val));
    return (u46_interp_cast(u129_dyn_unbox_read_val, u128_dyn_unbox_tyof, 7,
                            u110_blame_info));
  } else {
    puts(((const char *)u110_blame_info));
    exit(-1);
    return 0;
  }
}

int64_t u171_cast(int64_t u172_val, int64_t u173_tuple_type1,
                  int64_t u174_tuple_type2, int64_t u175_label,
                  int64_t u176_index, int64_t u177_tuple_type_num) {
  int64_t u333_tmp_value;
  int64_t u332_tmp_value;
  int64_t u331_tmp_value;
  int64_t u330_tmp_value;
  int64_t u329_tmp_value;
  int64_t u179_tuple_type2_item;
  int64_t u180_resulting_val;
  int64_t u181_resulting_val;
  int64_t u182_item_type;
  int64_t u178_tuple_type1_item;
  int64_t u183_item_val;
  if (u176_index == u177_tuple_type_num) {
    u180_resulting_val = alloc(8 * u177_tuple_type_num);
    return u180_resulting_val;
  } else {
    u183_item_val = ((long *)u172_val)[u176_index];
    u329_tmp_value = (u173_tuple_type1 ^ 3);
    u330_tmp_value = (1 + u176_index);
    u178_tuple_type1_item = ((long *)u329_tmp_value)[u330_tmp_value];
    u331_tmp_value = (u174_tuple_type2 ^ 3);
    u332_tmp_value = (1 + u176_index);
    u179_tuple_type2_item = ((long *)u331_tmp_value)[u332_tmp_value];
    u182_item_type = (u46_interp_cast(u183_item_val, u178_tuple_type1_item,
                                      u179_tuple_type2_item, u175_label));
    u333_tmp_value = (1 + u176_index);
    u181_resulting_val =
        (u171_cast(u172_val, u173_tuple_type1, u174_tuple_type2, u175_label,
                   u333_tmp_value, u177_tuple_type_num));
    ((long *)u181_resulting_val)[u176_index] = u182_item_type;
    return u181_resulting_val;
  }
}
