// fn-app-x0.schml should return #(struct:Int) generated by the schml compiler.

// This is the boiler plate
#include <stdint.h>
#include <stdio.h>
#include <stdlib.h>
#include <sys/time.h>

int64_t read_int();
void *alloc_ptr;
long free_ptr;
long limit;
unsigned long allocd_mem;

long alloc(int n) {
  long result = free_ptr;
  long newFree = result + n;
  allocd_mem += n;
  if (newFree >= limit) {
    puts("Requesting more memory\n");
    free_ptr = (long)(posix_memalign(&alloc_ptr, 8, 1048576), alloc_ptr);
    if (free_ptr == (long)NULL) {
      fputs("couldn't allocate any more memory", stderr);
      exit(EXIT_FAILURE);
    }
    limit = free_ptr + 1048576;
    return alloc(n);
  }
  free_ptr = newFree;
  return result;
}
// This is the global state for the timer
struct timeval timer_start_time;
struct timeval timer_stop_time;
struct timeval timer_result_time;
int timer_started = 1;
int timer_stopped = 1;

void timer_report() {

  // some very minor error checking
  if (timer_started) {
    printf("error starting timer");
    exit(-1);
  }
  if (timer_stopped) {
    printf("error stopping timer");
    exit(-1);
  }

  double t1 = timer_start_time.tv_sec + (timer_start_time.tv_usec / 1.0e6);
  double t2 = timer_stop_time.tv_sec + (timer_stop_time.tv_usec / 1.0e6);
  printf("time (sec): %lf\n", t2 - t1);
}

// These are the variable declarations

// These are the declarations
int64_t u1_run_test(int64_t u140_run_test_clos, int64_t u3_i, int64_t u2_acc);
int64_t u7_fn_cast_2(int64_t u8_f, int64_t u9_t1, int64_t u10_t2,
                     int64_t u11_lbl);
int64_t u136_annon(int64_t u137_annon_clos, int64_t u12_v, int64_t u13_v);
int64_t u71_gvec_set(int64_t u77_vec, int64_t u78_index, int64_t u79_value);
int64_t u70_gvec_ref(int64_t u75_vec, int64_t u76_index);
int64_t u69_gbox_set(int64_t u73_box, int64_t u74_value);
int64_t u68_gbox_ref(int64_t u72_box);
int64_t u14_cast_function(int64_t u15_value, int64_t u16_type1,
                          int64_t u17_type2, int64_t u18_blame_info);
int64_t u22_cast_gbox(int64_t u23_value, int64_t u24_type1, int64_t u25_type2,
                      int64_t u26_blame_info);
int64_t u30_cast_gvec(int64_t u31_value, int64_t u32_type1, int64_t u33_type2,
                      int64_t u34_blame_info);
int64_t u39_cast_tuple(int64_t u40_value, int64_t u41_type1, int64_t u42_type2,
                       int64_t u43_blame_info);
int64_t u47_cast_ground(int64_t u48_value, int64_t u49_type1, int64_t u50_type2,
                        int64_t u51_blame_info);
int64_t u53_cast_undyned(int64_t u54_value, int64_t u55_type1,
                         int64_t u56_type2, int64_t u57_blame_info);
int64_t u58_cast_dyn(int64_t u59_value, int64_t u60_type1, int64_t u61_type2,
                     int64_t u62_blame_info);
int64_t u38_interp_cast(int64_t u64_value, int64_t u65_type1, int64_t u66_type2,
                        int64_t u67_blame_info);
int64_t u112_dyn_gvec_set(int64_t u113_vector, int64_t u114_index,
                          int64_t u115_write_val, int64_t u116_val_type,
                          int64_t u117_blame_info);
int64_t u108_dyn_gvec_ref(int64_t u109_vector, int64_t u110_index,
                          int64_t u111_blame_info);
int64_t u103_dyn_gbox_set(int64_t u104_box, int64_t u105_write_val,
                          int64_t u106_val_type, int64_t u107_blame_info);
int64_t u100_dyn_gbox_ref(int64_t u101_box, int64_t u102_blame_info);
int64_t u162_cast(int64_t u163_val, int64_t u164_tuple_type1,
                  int64_t u165_tuple_type2, int64_t u166_label,
                  int64_t u167_index, int64_t u168_tuple_type_num);

// Obviously this is the main function
int main() {
  int64_t u209_stop;
  int64_t u208_start;
  int64_t u207_tmp_value;
  int64_t u206_tmp_value;
  int64_t u5_acc;
  int64_t u4_i;
  int64_t u205_result;
  int64_t u141_run_test_clos;
  int64_t u0_iters;
  int64_t u6_time_tmp;
  free_ptr = (long)(posix_memalign(&alloc_ptr, 8, 1048576), alloc_ptr);
  limit = free_ptr + 1048576;
  allocd_mem = 0;

  u0_iters = read_int();
  u141_run_test_clos = alloc(8 * 2);
  ((long *)u141_run_test_clos)[0] = ((long)u1_run_test);
  ((long *)u141_run_test_clos)[1] = ((long)u7_fn_cast_2);
  timer_started = gettimeofday(&timer_start_time, NULL);
  u5_acc = 0;
  u208_start = 0;
  u209_stop = u0_iters;
  for (u4_i = u208_start; u4_i < u209_stop; u4_i += 1) {
    u206_tmp_value = (-8 & u141_run_test_clos);
    u207_tmp_value = ((long *)u206_tmp_value)[0];
    u5_acc = (((int64_t(*)(int64_t, int64_t, int64_t))u207_tmp_value)(
        u141_run_test_clos, u4_i, u5_acc));
  };
  u6_time_tmp = u5_acc;
  timer_stopped = gettimeofday(&timer_stop_time, NULL);
  timer_report();
  u205_result = u6_time_tmp;
  printf("Int : %d\n", (void *)u205_result);
  return 0;
}

// Here are all the definitions for Subroutines
int64_t u1_run_test(int64_t u140_run_test_clos, int64_t u3_i, int64_t u2_acc) {
  return (1 + u2_acc);
}

int64_t u7_fn_cast_2(int64_t u8_f, int64_t u9_t1, int64_t u10_t2,
                     int64_t u11_lbl) {
  int64_t u138_annon_clos;
  u138_annon_clos = alloc(8 * 6);
  ((long *)u138_annon_clos)[0] = ((long)u136_annon);
  ((long *)u138_annon_clos)[1] = ((long)u7_fn_cast_2);
  ((long *)u138_annon_clos)[2] = u8_f;
  ((long *)u138_annon_clos)[3] = u10_t2;
  ((long *)u138_annon_clos)[4] = u11_lbl;
  ((long *)u138_annon_clos)[5] = u9_t1;
  return u138_annon_clos;
}

int64_t u136_annon(int64_t u137_annon_clos, int64_t u12_v, int64_t u13_v) {
  int64_t u239_tmp_value;
  int64_t u238_tmp_value;
  int64_t u237_tmp_value;
  int64_t u236_tmp_value;
  int64_t u235_tmp_value;
  int64_t u234_tmp_value;
  int64_t u233_tmp_value;
  int64_t u232_tmp_value;
  int64_t u231_tmp_value;
  int64_t u230_tmp_value;
  int64_t u229_tmp_value;
  int64_t u228_tmp_value;
  int64_t u227_tmp_value;
  int64_t u226_tmp_value;
  int64_t u225_tmp_value;
  int64_t u224_tmp_value;
  int64_t u223_tmp_value;
  int64_t u222_tmp_value;
  int64_t u221_tmp_value;
  int64_t u220_tmp_value;
  int64_t u219_tmp_value;
  int64_t u218_tmp_value;
  int64_t u217_tmp_value;
  int64_t u216_tmp_value;
  int64_t u215_tmp_value;
  int64_t u214_tmp_value;
  int64_t u213_tmp_value;
  int64_t u212_tmp_value;
  int64_t u211_tmp_value;
  int64_t u210_tmp_value;
  int64_t u139_tmp_closure;
  u210_tmp_value = (u137_annon_clos & -8);
  u139_tmp_closure = ((long *)u210_tmp_value)[2];
  u211_tmp_value = (-8 & u139_tmp_closure);
  u212_tmp_value = ((long *)u211_tmp_value)[0];
  u213_tmp_value = (u137_annon_clos & -8);
  u214_tmp_value = ((long *)u213_tmp_value)[3];
  u215_tmp_value = ((long *)u214_tmp_value)[2];
  u216_tmp_value = (u137_annon_clos & -8);
  u217_tmp_value = ((long *)u216_tmp_value)[5];
  u218_tmp_value = ((long *)u217_tmp_value)[2];
  u219_tmp_value = (u137_annon_clos & -8);
  u220_tmp_value = ((long *)u219_tmp_value)[4];
  u221_tmp_value =
      (u38_interp_cast(u12_v, u215_tmp_value, u218_tmp_value, u220_tmp_value));
  u222_tmp_value = (u137_annon_clos & -8);
  u223_tmp_value = ((long *)u222_tmp_value)[3];
  u224_tmp_value = ((long *)u223_tmp_value)[3];
  u225_tmp_value = (u137_annon_clos & -8);
  u226_tmp_value = ((long *)u225_tmp_value)[5];
  u227_tmp_value = ((long *)u226_tmp_value)[3];
  u228_tmp_value = (u137_annon_clos & -8);
  u229_tmp_value = ((long *)u228_tmp_value)[4];
  u230_tmp_value =
      (u38_interp_cast(u13_v, u224_tmp_value, u227_tmp_value, u229_tmp_value));
  u231_tmp_value = (((int64_t(*)(int64_t, int64_t, int64_t))u212_tmp_value)(
      u139_tmp_closure, u221_tmp_value, u230_tmp_value));
  u232_tmp_value = (u137_annon_clos & -8);
  u233_tmp_value = ((long *)u232_tmp_value)[5];
  u234_tmp_value = ((long *)u233_tmp_value)[1];
  u235_tmp_value = (u137_annon_clos & -8);
  u236_tmp_value = ((long *)u235_tmp_value)[3];
  u237_tmp_value = ((long *)u236_tmp_value)[1];
  u238_tmp_value = (u137_annon_clos & -8);
  u239_tmp_value = ((long *)u238_tmp_value)[4];
  return (u38_interp_cast(u231_tmp_value, u234_tmp_value, u237_tmp_value,
                          u239_tmp_value));
}

int64_t u71_gvec_set(int64_t u77_vec, int64_t u78_index, int64_t u79_value) {
  int64_t u246_tmp_value;
  int64_t u245_tmp_value;
  int64_t u244_tmp_value;
  int64_t u243_tmp_value;
  int64_t u242_tmp_value;
  int64_t u241_tmp_value;
  int64_t u240_tmp_value;
  int64_t u99_gvec_set_write_value;
  int64_t u98_gvec_set_proxied_blame_info;
  int64_t u97_gvec_set_proxied_target_type;
  int64_t u204_ugvect;
  int64_t u95_gvec_set_proxied_vector;
  int64_t u96_gvec_set_proxied_source_type;
  int64_t u203_index;
  u240_tmp_value = (u77_vec & 7);
  if (u240_tmp_value == 1) {
    u241_tmp_value = (u77_vec ^ 1);
    u95_gvec_set_proxied_vector = ((long *)u241_tmp_value)[0];
    u242_tmp_value = (u77_vec ^ 1);
    u96_gvec_set_proxied_source_type = ((long *)u242_tmp_value)[1];
    u243_tmp_value = (u77_vec ^ 1);
    u97_gvec_set_proxied_target_type = ((long *)u243_tmp_value)[2];
    u244_tmp_value = (u77_vec ^ 1);
    u98_gvec_set_proxied_blame_info = ((long *)u244_tmp_value)[3];
    u99_gvec_set_write_value = (u38_interp_cast(
        u79_value, u97_gvec_set_proxied_target_type,
        u96_gvec_set_proxied_source_type, u98_gvec_set_proxied_blame_info));
    return (u71_gvec_set(u95_gvec_set_proxied_vector, u78_index,
                         u99_gvec_set_write_value));
  } else {
    u203_index = u78_index;
    if (u203_index >= 0) {
      u204_ugvect = u77_vec;
      u245_tmp_value = ((long *)u204_ugvect)[0];
      if (u203_index < u245_tmp_value) {
        u246_tmp_value = (u203_index + 1);
        ((long *)u204_ugvect)[u246_tmp_value] = u79_value;
        return 0;
      } else {
        printf("index out of bound %l\n", (void *)u203_index);
        exit(-1);
        return 0;
      }
    } else {
      printf("index out of bound %l\n", (void *)u203_index);
      exit(-1);
      return 0;
    }
  }
}

int64_t u70_gvec_ref(int64_t u75_vec, int64_t u76_index) {
  int64_t u253_tmp_value;
  int64_t u252_tmp_value;
  int64_t u251_tmp_value;
  int64_t u250_tmp_value;
  int64_t u249_tmp_value;
  int64_t u248_tmp_value;
  int64_t u247_tmp_value;
  int64_t u90_gvec_ref_proxied_vector;
  int64_t u201_index;
  int64_t u92_gvec_ref_proxied_target_type;
  int64_t u94_gvec_ref_read_value;
  int64_t u91_gvec_ref_proxied_source_type;
  int64_t u93_gvec_ref_proxied_blame_info;
  int64_t u202_e;
  u247_tmp_value = (u75_vec & 7);
  if (u247_tmp_value == 1) {
    u248_tmp_value = (u75_vec ^ 1);
    u90_gvec_ref_proxied_vector = ((long *)u248_tmp_value)[0];
    u249_tmp_value = (u75_vec ^ 1);
    u91_gvec_ref_proxied_source_type = ((long *)u249_tmp_value)[1];
    u250_tmp_value = (u75_vec ^ 1);
    u92_gvec_ref_proxied_target_type = ((long *)u250_tmp_value)[2];
    u251_tmp_value = (u75_vec ^ 1);
    u93_gvec_ref_proxied_blame_info = ((long *)u251_tmp_value)[3];
    u94_gvec_ref_read_value =
        (u70_gvec_ref(u90_gvec_ref_proxied_vector, u76_index));
    return (u38_interp_cast(
        u94_gvec_ref_read_value, u91_gvec_ref_proxied_source_type,
        u92_gvec_ref_proxied_target_type, u93_gvec_ref_proxied_blame_info));
  } else {
    u201_index = u76_index;
    u202_e = u75_vec;
    if (u201_index >= 0) {
      u252_tmp_value = ((long *)u202_e)[0];
      if (u201_index < u252_tmp_value) {
        u253_tmp_value = (u201_index + 1);
        return ((long *)u202_e)[u253_tmp_value];
      } else {
        printf("index out of bound %l\n", (void *)u201_index);
        exit(-1);
        return 0;
      }
    } else {
      printf("index out of bound %l\n", (void *)u201_index);
      exit(-1);
      return 0;
    }
  }
}

int64_t u69_gbox_set(int64_t u73_box, int64_t u74_value) {
  int64_t u258_tmp_value;
  int64_t u257_tmp_value;
  int64_t u256_tmp_value;
  int64_t u255_tmp_value;
  int64_t u254_tmp_value;
  int64_t u89_gbox_set_write_value;
  int64_t u86_gbox_set_proxied_source_type;
  int64_t u87_gbox_set_proxied_target_type;
  int64_t u88_gbox_set_proxied_blame_info;
  int64_t u85_gbox_set_proxied_box;
  u254_tmp_value = (u73_box & 7);
  if (u254_tmp_value == 1) {
    u255_tmp_value = (u73_box ^ 1);
    u85_gbox_set_proxied_box = ((long *)u255_tmp_value)[0];
    u256_tmp_value = (u73_box ^ 1);
    u86_gbox_set_proxied_source_type = ((long *)u256_tmp_value)[1];
    u257_tmp_value = (u73_box ^ 1);
    u87_gbox_set_proxied_target_type = ((long *)u257_tmp_value)[2];
    u258_tmp_value = (u73_box ^ 1);
    u88_gbox_set_proxied_blame_info = ((long *)u258_tmp_value)[3];
    u89_gbox_set_write_value = (u38_interp_cast(
        u74_value, u87_gbox_set_proxied_target_type,
        u86_gbox_set_proxied_source_type, u88_gbox_set_proxied_blame_info));
    return (u69_gbox_set(u85_gbox_set_proxied_box, u89_gbox_set_write_value));
  } else {
    ((long *)u73_box)[0] = u74_value;
    return 0;
  }
}

int64_t u68_gbox_ref(int64_t u72_box) {
  int64_t u263_tmp_value;
  int64_t u262_tmp_value;
  int64_t u261_tmp_value;
  int64_t u260_tmp_value;
  int64_t u259_tmp_value;
  int64_t u84_gbox_ref_read_value;
  int64_t u81_gbox_ref_proxied_source_type;
  int64_t u80_gbox_ref_proxied_box;
  int64_t u83_gbox_ref_proxied_blame_info;
  int64_t u82_gbox_ref_proxied_target_type;
  u259_tmp_value = (u72_box & 7);
  if (u259_tmp_value == 1) {
    u260_tmp_value = (u72_box ^ 1);
    u80_gbox_ref_proxied_box = ((long *)u260_tmp_value)[0];
    u261_tmp_value = (u72_box ^ 1);
    u81_gbox_ref_proxied_source_type = ((long *)u261_tmp_value)[1];
    u262_tmp_value = (u72_box ^ 1);
    u82_gbox_ref_proxied_target_type = ((long *)u262_tmp_value)[2];
    u263_tmp_value = (u72_box ^ 1);
    u83_gbox_ref_proxied_blame_info = ((long *)u263_tmp_value)[3];
    u84_gbox_ref_read_value = (u68_gbox_ref(u80_gbox_ref_proxied_box));
    return (u38_interp_cast(
        u84_gbox_ref_read_value, u81_gbox_ref_proxied_source_type,
        u82_gbox_ref_proxied_target_type, u83_gbox_ref_proxied_blame_info));
  } else {
    return ((long *)u72_box)[0];
  }
}

int64_t u14_cast_function(int64_t u15_value, int64_t u16_type1,
                          int64_t u17_type2, int64_t u18_blame_info) {
  int64_t u265_tmp_value;
  int64_t u264_tmp_value;
  int64_t u21_type2_arity;
  int64_t u198_tag;
  int64_t u200_dynamic_boxed;
  int64_t u19_tag2;
  int64_t u196_value;
  int64_t u20_type1_arity;
  int64_t u197_type;
  int64_t u199_imm;
  if (7 == u17_type2) {
    u196_value = u15_value;
    u197_type = u16_type1;
    u198_tag = (u197_type & 7);
    if (u198_tag == 7) {
      u199_imm = (u196_value << 3);
      if (u197_type == 15) {
        return (u199_imm | 1);
      } else {
        if (u197_type == 23) {
          return (u199_imm | 7);
        } else {
          return (u199_imm | 2);
        }
      }
    } else {
      u200_dynamic_boxed = alloc(8 * 2);
      ((long *)u200_dynamic_boxed)[0] = u196_value;
      ((long *)u200_dynamic_boxed)[1] = u197_type;
      return u200_dynamic_boxed;
    }
  } else {
    u19_tag2 = (u17_type2 & 7);
    if (u19_tag2 == 0) {
      u20_type1_arity = ((long *)u16_type1)[0];
      u21_type2_arity = ((long *)u17_type2)[0];
      if (u20_type1_arity == u21_type2_arity) {
        u264_tmp_value = (-8 & u15_value);
        u265_tmp_value = ((long *)u264_tmp_value)[1];
        return (
            ((int64_t(*)(int64_t, int64_t, int64_t, int64_t))u265_tmp_value)(
                u15_value, u16_type1, u17_type2, u18_blame_info));
      } else {
        puts(((const char *)u18_blame_info));
        exit(-1);
        return 0;
      }
    } else {
      puts(((const char *)u18_blame_info));
      exit(-1);
      return 0;
    }
  }
}

int64_t u22_cast_gbox(int64_t u23_value, int64_t u24_type1, int64_t u25_type2,
                      int64_t u26_blame_info) {
  int64_t u267_tmp_value;
  int64_t u266_tmp_value;
  int64_t u27_tag_gref;
  int64_t u192_guarded_ref;
  int64_t u188_tag;
  int64_t u186_value;
  int64_t u195_blame;
  int64_t u191_guarded_proxy;
  int64_t u28_g1;
  int64_t u190_dynamic_boxed;
  int64_t u194_target_t;
  int64_t u193_source_t;
  int64_t u29_g2;
  int64_t u187_type;
  int64_t u189_imm;
  if (7 == u25_type2) {
    u186_value = u23_value;
    u187_type = u24_type1;
    u188_tag = (u187_type & 7);
    if (u188_tag == 7) {
      u189_imm = (u186_value << 3);
      if (u187_type == 15) {
        return (u189_imm | 1);
      } else {
        if (u187_type == 23) {
          return (u189_imm | 7);
        } else {
          return (u189_imm | 2);
        }
      }
    } else {
      u190_dynamic_boxed = alloc(8 * 2);
      ((long *)u190_dynamic_boxed)[0] = u186_value;
      ((long *)u190_dynamic_boxed)[1] = u187_type;
      return u190_dynamic_boxed;
    }
  } else {
    u27_tag_gref = (u25_type2 & 7);
    if (u27_tag_gref == 1) {
      u266_tmp_value = (u24_type1 ^ 1);
      u28_g1 = ((long *)u266_tmp_value)[0];
      u267_tmp_value = (u25_type2 ^ 1);
      u29_g2 = ((long *)u267_tmp_value)[0];
      u192_guarded_ref = u23_value;
      u193_source_t = u28_g1;
      u194_target_t = u29_g2;
      u195_blame = u26_blame_info;
      u191_guarded_proxy = alloc(8 * 4);
      ((long *)u191_guarded_proxy)[0] = u192_guarded_ref;
      ((long *)u191_guarded_proxy)[1] = u193_source_t;
      ((long *)u191_guarded_proxy)[2] = u194_target_t;
      ((long *)u191_guarded_proxy)[3] = u195_blame;
      return (u191_guarded_proxy | 1);
    } else {
      puts(((const char *)u26_blame_info));
      exit(-1);
      return 0;
    }
  }
}

int64_t u30_cast_gvec(int64_t u31_value, int64_t u32_type1, int64_t u33_type2,
                      int64_t u34_blame_info) {
  int64_t u269_tmp_value;
  int64_t u268_tmp_value;
  int64_t u182_guarded_ref;
  int64_t u37_g2;
  int64_t u177_type;
  int64_t u183_source_t;
  int64_t u179_imm;
  int64_t u36_g1;
  int64_t u181_guarded_proxy;
  int64_t u178_tag;
  int64_t u180_dynamic_boxed;
  int64_t u176_value;
  int64_t u35_tag_gvect;
  int64_t u185_blame;
  int64_t u184_target_t;
  if (7 == u33_type2) {
    u176_value = u31_value;
    u177_type = u32_type1;
    u178_tag = (u177_type & 7);
    if (u178_tag == 7) {
      u179_imm = (u176_value << 3);
      if (u177_type == 15) {
        return (u179_imm | 1);
      } else {
        if (u177_type == 23) {
          return (u179_imm | 7);
        } else {
          return (u179_imm | 2);
        }
      }
    } else {
      u180_dynamic_boxed = alloc(8 * 2);
      ((long *)u180_dynamic_boxed)[0] = u176_value;
      ((long *)u180_dynamic_boxed)[1] = u177_type;
      return u180_dynamic_boxed;
    }
  } else {
    u35_tag_gvect = (u33_type2 & 7);
    if (u35_tag_gvect == 2) {
      u268_tmp_value = (u32_type1 ^ 2);
      u36_g1 = ((long *)u268_tmp_value)[0];
      u269_tmp_value = (u33_type2 ^ 2);
      u37_g2 = ((long *)u269_tmp_value)[0];
      u182_guarded_ref = u31_value;
      u183_source_t = u36_g1;
      u184_target_t = u37_g2;
      u185_blame = u34_blame_info;
      u181_guarded_proxy = alloc(8 * 4);
      ((long *)u181_guarded_proxy)[0] = u182_guarded_ref;
      ((long *)u181_guarded_proxy)[1] = u183_source_t;
      ((long *)u181_guarded_proxy)[2] = u184_target_t;
      ((long *)u181_guarded_proxy)[3] = u185_blame;
      return (u181_guarded_proxy | 1);
    } else {
      puts(((const char *)u34_blame_info));
      exit(-1);
      return 0;
    }
  }
}

int64_t u39_cast_tuple(int64_t u40_value, int64_t u41_type1, int64_t u42_type2,
                       int64_t u43_blame_info) {
  int64_t u272_tmp_value;
  int64_t u271_tmp_value;
  int64_t u270_tmp_value;
  int64_t u44_tag2;
  int64_t u45_type1_num;
  int64_t u46_type2_num;
  int64_t u161_dynamic_boxed;
  int64_t u158_type;
  int64_t u157_value;
  int64_t u175_num;
  int64_t u160_imm;
  int64_t u159_tag;
  if (7 == u42_type2) {
    u157_value = u40_value;
    u158_type = u41_type1;
    u159_tag = (u158_type & 7);
    if (u159_tag == 7) {
      u160_imm = (u157_value << 3);
      if (u158_type == 15) {
        return (u160_imm | 1);
      } else {
        if (u158_type == 23) {
          return (u160_imm | 7);
        } else {
          return (u160_imm | 2);
        }
      }
    } else {
      u161_dynamic_boxed = alloc(8 * 2);
      ((long *)u161_dynamic_boxed)[0] = u157_value;
      ((long *)u161_dynamic_boxed)[1] = u158_type;
      return u161_dynamic_boxed;
    }
  } else {
    u44_tag2 = (u42_type2 & 7);
    if (u44_tag2 == 3) {
      u270_tmp_value = (u41_type1 ^ 3);
      u45_type1_num = ((long *)u270_tmp_value)[0];
      u271_tmp_value = (u42_type2 ^ 3);
      u46_type2_num = ((long *)u271_tmp_value)[0];
      if (u46_type2_num <= u45_type1_num) {
        u272_tmp_value = (u42_type2 ^ 3);
        u175_num = ((long *)u272_tmp_value)[0];
        return (u162_cast(u40_value, u41_type1, u42_type2, u43_blame_info, 0,
                          u175_num));
      } else {
        puts(((const char *)u46_type2_num));
        exit(-1);
        return 0;
      }
    } else {
      puts(((const char *)u43_blame_info));
      exit(-1);
      return 0;
    }
  }
}

int64_t u47_cast_ground(int64_t u48_value, int64_t u49_type1, int64_t u50_type2,
                        int64_t u51_blame_info) {
  int64_t u275_tmp_value;
  int64_t u274_tmp_value;
  int64_t u273_tmp_value;
  int64_t u52_tag1;
  if (u49_type1 == 15) {
    if (7 == u50_type2) {
      u273_tmp_value = (u48_value << 3);
      return (u273_tmp_value + 1);
    } else {
      puts(((const char *)u51_blame_info));
      exit(-1);
      return 0;
    }
  } else {
    if (u49_type1 == 23) {
      if (7 == u50_type2) {
        u274_tmp_value = (u48_value << 3);
        return (u274_tmp_value + 7);
      } else {
        puts(((const char *)u51_blame_info));
        exit(-1);
        return 0;
      }
    } else {
      if (u49_type1 == 31) {
        if (7 == u50_type2) {
          u275_tmp_value = (u48_value << 3);
          return (u275_tmp_value + 2);
        } else {
          puts(((const char *)u51_blame_info));
          exit(-1);
          return 0;
        }
      } else {
        u52_tag1 = (u49_type1 & 7);
        if (0 == u52_tag1) {
          return (u14_cast_function(u48_value, u49_type1, u50_type2,
                                    u51_blame_info));
        } else {
          if (1 == u52_tag1) {
            return (
                u22_cast_gbox(u48_value, u49_type1, u50_type2, u51_blame_info));
          } else {
            if (2 == u52_tag1) {
              return (u30_cast_gvec(u48_value, u49_type1, u50_type2,
                                    u51_blame_info));
            } else {
              if (3 == u52_tag1) {
                return (u39_cast_tuple(u48_value, u49_type1, u50_type2,
                                       u51_blame_info));
              } else {
                puts(((const char *)"Unexpected Type1 in cast tree"));
                exit(-1);
                return 0;
              }
            }
          }
        }
      }
    }
  }
}

int64_t u53_cast_undyned(int64_t u54_value, int64_t u55_type1,
                         int64_t u56_type2, int64_t u57_blame_info) {
  if (u55_type1 == u56_type2) {
    return u54_value;
  } else {
    return (u47_cast_ground(u54_value, u55_type1, u56_type2, u57_blame_info));
  }
}

int64_t u58_cast_dyn(int64_t u59_value, int64_t u60_type1, int64_t u61_type2,
                     int64_t u62_blame_info) {
  int64_t u284_tmp;
  int64_t u283_tmp;
  int64_t u282_tmp;
  int64_t u281_tmp_value;
  int64_t u280_tmp;
  int64_t u279_tmp_value;
  int64_t u278_tmp_value;
  int64_t u277_tmp_value;
  int64_t u276_tmp_value;
  int64_t u63_tag;
  int64_t u154_dyn_value_tag;
  int64_t u153_dyn_value_tmp;
  int64_t u156_tag;
  int64_t u155_tmp;
  u63_tag = (u59_value & 7);
  if (1 == u63_tag) {
    u276_tmp_value = (u59_value >> 3);
    return (u53_cast_undyned(u276_tmp_value, 15, u61_type2, u62_blame_info));
  } else {
    if (7 == u63_tag) {
      u277_tmp_value = (u59_value >> 3);
      return (u53_cast_undyned(u277_tmp_value, 23, u61_type2, u62_blame_info));
    } else {
      if (2 == u63_tag) {
        return (u53_cast_undyned(0, 31, u61_type2, u62_blame_info));
      } else {
        if (0 == u63_tag) {
          u153_dyn_value_tmp = u59_value;
          u154_dyn_value_tag = (u153_dyn_value_tmp & 7);
          if (u154_dyn_value_tag == 0) {
            u278_tmp_value = ((long *)u153_dyn_value_tmp)[0];
            u280_tmp = u278_tmp_value;
          } else {
            u279_tmp_value = (u153_dyn_value_tmp >> 3);
            u280_tmp = u279_tmp_value;
          };
          u155_tmp = u59_value;
          u156_tag = (u155_tmp & 7);
          if (u156_tag == 0) {
            u281_tmp_value = ((long *)u155_tmp)[1];
            u284_tmp = u281_tmp_value;
          } else {
            if (u156_tag == 1) {
              u283_tmp = 15;
            } else {
              if (u156_tag == 7) {
                u282_tmp = 23;
              } else {
                u282_tmp = 31;
              };
              u283_tmp = u282_tmp;
            };
            u284_tmp = u283_tmp;
          };
          return (
              u53_cast_undyned(u280_tmp, u284_tmp, u61_type2, u62_blame_info));
        } else {
          puts(((const char *)"Unexpected value in cast tree"));
          exit(-1);
          return 0;
        }
      }
    }
  }
}

int64_t u38_interp_cast(int64_t u64_value, int64_t u65_type1, int64_t u66_type2,
                        int64_t u67_blame_info) {
  if (u65_type1 == u66_type2) {
    return u64_value;
  } else {
    if (u65_type1 == 7) {
      return (u58_cast_dyn(u64_value, u65_type1, u66_type2, u67_blame_info));
    } else {
      return (u47_cast_ground(u64_value, u65_type1, u66_type2, u67_blame_info));
    }
  }
}

int64_t u112_dyn_gvec_set(int64_t u113_vector, int64_t u114_index,
                          int64_t u115_write_val, int64_t u116_val_type,
                          int64_t u117_blame_info) {
  int64_t u287_tmp_value;
  int64_t u286_tmp_value;
  int64_t u285_tmp_value;
  int64_t u133_dyn_setbox_tyof;
  int64_t u132_dyn_setbox_ty;
  int64_t u152_tag;
  int64_t u135_dyn_setbox_write_value3;
  int64_t u151_tmp;
  int64_t u149_dyn_value_tmp;
  int64_t u150_dyn_value_tag;
  int64_t u131_dyn_setbox_gvect_value;
  u149_dyn_value_tmp = u113_vector;
  u150_dyn_value_tag = (u149_dyn_value_tmp & 7);
  if (u150_dyn_value_tag == 0) {
    u131_dyn_setbox_gvect_value = ((long *)u149_dyn_value_tmp)[0];
  } else {
    u131_dyn_setbox_gvect_value = (u149_dyn_value_tmp >> 3);
  };
  u151_tmp = u113_vector;
  u152_tag = (u151_tmp & 7);
  if (u152_tag == 0) {
    u132_dyn_setbox_ty = ((long *)u151_tmp)[1];
  } else {
    if (u152_tag == 1) {
      u132_dyn_setbox_ty = 15;
    } else {
      if (u152_tag == 7) {
        u132_dyn_setbox_ty = 23;
      } else {
        u132_dyn_setbox_ty = 31;
      };
    };
  };
  u285_tmp_value = (u132_dyn_setbox_ty & 7);
  if (u285_tmp_value == 2) {
    u286_tmp_value = (u132_dyn_setbox_ty ^ 2);
    u133_dyn_setbox_tyof = ((long *)u286_tmp_value)[0];
    u135_dyn_setbox_write_value3 = (u38_interp_cast(
        u115_write_val, u116_val_type, u133_dyn_setbox_tyof, u117_blame_info));
    u287_tmp_value = (u71_gvec_set(u131_dyn_setbox_gvect_value, u114_index,
                                   u135_dyn_setbox_write_value3));
    return (u38_interp_cast(u287_tmp_value, u133_dyn_setbox_tyof, 7,
                            u117_blame_info));
  } else {
    puts(((const char *)u117_blame_info));
    exit(-1);
    return 0;
  }
}

int64_t u108_dyn_gvec_ref(int64_t u109_vector, int64_t u110_index,
                          int64_t u111_blame_info) {
  int64_t u289_tmp_value;
  int64_t u288_tmp_value;
  int64_t u146_dyn_value_tag;
  int64_t u128_dyn_gvec_ref_ty;
  int64_t u130_dyn_gvec_ref_read_val;
  int64_t u147_tmp;
  int64_t u129_dyn_gvec_ref_tyof;
  int64_t u148_tag;
  int64_t u145_dyn_value_tmp;
  int64_t u127_dyn_gvec_ref_val;
  u145_dyn_value_tmp = u109_vector;
  u146_dyn_value_tag = (u145_dyn_value_tmp & 7);
  if (u146_dyn_value_tag == 0) {
    u127_dyn_gvec_ref_val = ((long *)u145_dyn_value_tmp)[0];
  } else {
    u127_dyn_gvec_ref_val = (u145_dyn_value_tmp >> 3);
  };
  u147_tmp = u109_vector;
  u148_tag = (u147_tmp & 7);
  if (u148_tag == 0) {
    u128_dyn_gvec_ref_ty = ((long *)u147_tmp)[1];
  } else {
    if (u148_tag == 1) {
      u128_dyn_gvec_ref_ty = 15;
    } else {
      if (u148_tag == 7) {
        u128_dyn_gvec_ref_ty = 23;
      } else {
        u128_dyn_gvec_ref_ty = 31;
      };
    };
  };
  u288_tmp_value = (u128_dyn_gvec_ref_ty & 7);
  if (u288_tmp_value == 2) {
    u289_tmp_value = (u128_dyn_gvec_ref_ty ^ 2);
    u129_dyn_gvec_ref_tyof = ((long *)u289_tmp_value)[0];
    u130_dyn_gvec_ref_read_val =
        (u70_gvec_ref(u127_dyn_gvec_ref_val, u110_index));
    return (u38_interp_cast(u130_dyn_gvec_ref_read_val, u129_dyn_gvec_ref_tyof,
                            7, u111_blame_info));
  } else {
    puts(((const char *)u111_blame_info));
    exit(-1);
    return 0;
  }
}

int64_t u103_dyn_gbox_set(int64_t u104_box, int64_t u105_write_val,
                          int64_t u106_val_type, int64_t u107_blame_info) {
  int64_t u292_tmp_value;
  int64_t u291_tmp_value;
  int64_t u290_tmp_value;
  int64_t u122_dyn_setbox_gbox;
  int64_t u142_dyn_value_tag;
  int64_t u123_dyn_setbox_ty;
  int64_t u126_dyn_setbox_wrt_val3;
  int64_t u124_dyn_setbox_tyof;
  int64_t u144_tag;
  int64_t u141_dyn_value_tmp;
  int64_t u143_tmp;
  u141_dyn_value_tmp = u104_box;
  u142_dyn_value_tag = (u141_dyn_value_tmp & 7);
  if (u142_dyn_value_tag == 0) {
    u122_dyn_setbox_gbox = ((long *)u141_dyn_value_tmp)[0];
  } else {
    u122_dyn_setbox_gbox = (u141_dyn_value_tmp >> 3);
  };
  u143_tmp = u104_box;
  u144_tag = (u143_tmp & 7);
  if (u144_tag == 0) {
    u123_dyn_setbox_ty = ((long *)u143_tmp)[1];
  } else {
    if (u144_tag == 1) {
      u123_dyn_setbox_ty = 15;
    } else {
      if (u144_tag == 7) {
        u123_dyn_setbox_ty = 23;
      } else {
        u123_dyn_setbox_ty = 31;
      };
    };
  };
  u290_tmp_value = (u123_dyn_setbox_ty & 7);
  if (u290_tmp_value == 1) {
    u291_tmp_value = (u123_dyn_setbox_ty ^ 1);
    u124_dyn_setbox_tyof = ((long *)u291_tmp_value)[0];
    u126_dyn_setbox_wrt_val3 = (u38_interp_cast(
        u105_write_val, u106_val_type, u124_dyn_setbox_tyof, u107_blame_info));
    u292_tmp_value =
        (u69_gbox_set(u122_dyn_setbox_gbox, u126_dyn_setbox_wrt_val3));
    return (u38_interp_cast(u292_tmp_value, u124_dyn_setbox_tyof, 7,
                            u107_blame_info));
  } else {
    puts(((const char *)u107_blame_info));
    exit(-1);
    return 0;
  }
}

int64_t u100_dyn_gbox_ref(int64_t u101_box, int64_t u102_blame_info) {
  int64_t u294_tmp_value;
  int64_t u293_tmp_value;
  int64_t u121_dyn_unbox_read_val;
  int64_t u140_tag;
  int64_t u118_dyn_unbox_val;
  int64_t u139_tmp;
  int64_t u120_dyn_unbox_tyof;
  int64_t u119_dyn_unbox_ty;
  int64_t u137_dyn_value_tmp;
  int64_t u138_dyn_value_tag;
  u137_dyn_value_tmp = u101_box;
  u138_dyn_value_tag = (u137_dyn_value_tmp & 7);
  if (u138_dyn_value_tag == 0) {
    u118_dyn_unbox_val = ((long *)u137_dyn_value_tmp)[0];
  } else {
    u118_dyn_unbox_val = (u137_dyn_value_tmp >> 3);
  };
  u139_tmp = u101_box;
  u140_tag = (u139_tmp & 7);
  if (u140_tag == 0) {
    u119_dyn_unbox_ty = ((long *)u139_tmp)[1];
  } else {
    if (u140_tag == 1) {
      u119_dyn_unbox_ty = 15;
    } else {
      if (u140_tag == 7) {
        u119_dyn_unbox_ty = 23;
      } else {
        u119_dyn_unbox_ty = 31;
      };
    };
  };
  u293_tmp_value = (u119_dyn_unbox_ty & 7);
  if (u293_tmp_value == 1) {
    u294_tmp_value = (u119_dyn_unbox_ty ^ 1);
    u120_dyn_unbox_tyof = ((long *)u294_tmp_value)[0];
    u121_dyn_unbox_read_val = (u68_gbox_ref(u118_dyn_unbox_val));
    return (u38_interp_cast(u121_dyn_unbox_read_val, u120_dyn_unbox_tyof, 7,
                            u102_blame_info));
  } else {
    puts(((const char *)u102_blame_info));
    exit(-1);
    return 0;
  }
}

int64_t u162_cast(int64_t u163_val, int64_t u164_tuple_type1,
                  int64_t u165_tuple_type2, int64_t u166_label,
                  int64_t u167_index, int64_t u168_tuple_type_num) {
  int64_t u299_tmp_value;
  int64_t u298_tmp_value;
  int64_t u297_tmp_value;
  int64_t u296_tmp_value;
  int64_t u295_tmp_value;
  int64_t u169_tuple_type1_item;
  int64_t u170_tuple_type2_item;
  int64_t u171_resulting_val;
  int64_t u173_item_type;
  int64_t u172_resulting_val;
  int64_t u174_item_val;
  if (u167_index == u168_tuple_type_num) {
    u171_resulting_val = alloc(8 * u168_tuple_type_num);
    return u171_resulting_val;
  } else {
    u174_item_val = ((long *)u163_val)[u167_index];
    u295_tmp_value = (u164_tuple_type1 ^ 3);
    u296_tmp_value = (1 + u167_index);
    u169_tuple_type1_item = ((long *)u295_tmp_value)[u296_tmp_value];
    u297_tmp_value = (u165_tuple_type2 ^ 3);
    u298_tmp_value = (1 + u167_index);
    u170_tuple_type2_item = ((long *)u297_tmp_value)[u298_tmp_value];
    u173_item_type = (u38_interp_cast(u174_item_val, u169_tuple_type1_item,
                                      u170_tuple_type2_item, u166_label));
    u299_tmp_value = (1 + u167_index);
    u172_resulting_val =
        (u162_cast(u163_val, u164_tuple_type1, u165_tuple_type2, u166_label,
                   u299_tmp_value, u168_tuple_type_num));
    ((long *)u172_resulting_val)[u167_index] = u173_item_type;
    return u172_resulting_val;
  }
}
